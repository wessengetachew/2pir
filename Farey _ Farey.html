<!DOCTYPE html>
<!-- saved from url=(0039)https://wessengetachew.github.io/Farey/ -->
<html lang="en-US"><div id="in-page-channel-node-id" data-channel-name="in_page_channel_CIe3kI"></div><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Farey | Farey</title>
<meta name="generator" content="Jekyll v3.10.0">
<meta property="og:title" content="Farey">
<meta property="og:locale" content="en_US">
<meta name="description" content="Farey">
<meta property="og:description" content="Farey">
<link rel="canonical" href="https://wessengetachew.github.io/Farey/">
<meta property="og:url" content="https://wessengetachew.github.io/Farey/">
<meta property="og:site_name" content="Farey">
<meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Farey">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","description":"Farey","headline":"Farey","name":"Farey","url":"https://wessengetachew.github.io/Farey/"}</script>
<!-- End Jekyll SEO tag -->

    <style class="anchorjs"></style><link rel="stylesheet" href="./Farey _ Farey_files/style.css">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/Farey/favicon.ico" -->

<!-- end custom head snippets -->

  <style type="text/css">.CtxtMenu_InfoClose {  top:.2em; right:.2em;}
.CtxtMenu_InfoContent {  overflow:auto; text-align:left; font-size:80%;  padding:.4em .6em; border:1px inset; margin:1em 0px;  max-height:20em; max-width:30em; background-color:#EEEEEE;  white-space:normal;}
.CtxtMenu_Info.CtxtMenu_MousePost {outline:none;}
.CtxtMenu_Info {  position:fixed; left:50%; width:auto; text-align:center;  border:3px outset; padding:1em 2em; background-color:#DDDDDD;  color:black;  cursor:default; font-family:message-box; font-size:120%;  font-style:normal; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 15px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius:15px;               /* Safari and Chrome */  -moz-border-radius:15px;                  /* Firefox */  -khtml-border-radius:15px;                /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */  filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */}
</style><style type="text/css">.CtxtMenu_MenuClose {  position:absolute;  cursor:pointer;  display:inline-block;  border:2px solid #AAA;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  font-family: "Courier New", Courier;  font-size:24px;  color:#F0F0F0}
.CtxtMenu_MenuClose span {  display:block; background-color:#AAA; border:1.5px solid;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  line-height:0;  padding:8px 0 6px     /* may need to be browser-specific */}
.CtxtMenu_MenuClose:hover {  color:white!important;  border:2px solid #CCC!important}
.CtxtMenu_MenuClose:hover span {  background-color:#CCC!important}
.CtxtMenu_MenuClose:hover:focus {  outline:none}
</style><style type="text/css">.CtxtMenu_Menu {  position:absolute;  background-color:white;  color:black;  width:auto; padding:5px 0px;  border:1px solid #CCCCCC; margin:0; cursor:default;  font: menu; text-align:left; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 5px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius: 5px;             /* Safari and Chrome */  -moz-border-radius: 5px;                /* Firefox */  -khtml-border-radius: 5px;              /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */}
.CtxtMenu_MenuItem {  padding: 1px 2em;  background:transparent;}
.CtxtMenu_MenuArrow {  position:absolute; right:.5em; padding-top:.25em; color:#666666;  font-family: null; font-size: .75em}
.CtxtMenu_MenuActive .CtxtMenu_MenuArrow {color:white}
.CtxtMenu_MenuArrow.CtxtMenu_RTL {left:.5em; right:auto}
.CtxtMenu_MenuCheck {  position:absolute; left:.7em;  font-family: null}
.CtxtMenu_MenuCheck.CtxtMenu_RTL { right:.7em; left:auto }
.CtxtMenu_MenuRadioCheck {  position:absolute; left: .7em;}
.CtxtMenu_MenuRadioCheck.CtxtMenu_RTL {  right: .7em; left:auto}
.CtxtMenu_MenuInputBox {  padding-left: 1em; right:.5em; color:#666666;  font-family: null;}
.CtxtMenu_MenuInputBox.CtxtMenu_RTL {  left: .1em;}
.CtxtMenu_MenuComboBox {  left:.1em; padding-bottom:.5em;}
.CtxtMenu_MenuSlider {  left: .1em;}
.CtxtMenu_SliderValue {  position:absolute; right:.1em; padding-top:.25em; color:#333333;  font-size: .75em}
.CtxtMenu_SliderBar {  outline: none; background: #d3d3d3}
.CtxtMenu_MenuLabel {  padding: 1px 2em 3px 1.33em;  font-style:italic}
.CtxtMenu_MenuRule {  border-top: 1px solid #DDDDDD;  margin: 4px 3px;}
.CtxtMenu_MenuDisabled {  color:GrayText}
.CtxtMenu_MenuActive {  background-color: #606872;  color: white;}
.CtxtMenu_MenuDisabled:focus {  background-color: #E8E8E8}
.CtxtMenu_MenuLabel:focus {  background-color: #E8E8E8}
.CtxtMenu_ContextMenu:focus {  outline:none}
.CtxtMenu_ContextMenu .CtxtMenu_MenuItem:focus {  outline:none}
.CtxtMenu_SelectionMenu {  position:relative; float:left;  border-bottom: none; -webkit-box-shadow:none; -webkit-border-radius:0px; }
.CtxtMenu_SelectionItem {  padding-right: 1em;}
.CtxtMenu_Selection {  right: 40%; width:50%; }
.CtxtMenu_SelectionBox {  padding: 0em; max-height:20em; max-width: none;  background-color:#FFFFFF;}
.CtxtMenu_SelectionDivider {  clear: both; border-top: 2px solid #000000;}
.CtxtMenu_Menu .CtxtMenu_MenuClose {  top:-10px; left:-10px}
</style><style id="MJX-CHTML-styles">
mjx-container[jax="CHTML"] {
  line-height: 0;
}

mjx-container [space="1"] {
  margin-left: .111em;
}

mjx-container [space="2"] {
  margin-left: .167em;
}

mjx-container [space="3"] {
  margin-left: .222em;
}

mjx-container [space="4"] {
  margin-left: .278em;
}

mjx-container [space="5"] {
  margin-left: .333em;
}

mjx-container [rspace="1"] {
  margin-right: .111em;
}

mjx-container [rspace="2"] {
  margin-right: .167em;
}

mjx-container [rspace="3"] {
  margin-right: .222em;
}

mjx-container [rspace="4"] {
  margin-right: .278em;
}

mjx-container [rspace="5"] {
  margin-right: .333em;
}

mjx-container [size="s"] {
  font-size: 70.7%;
}

mjx-container [size="ss"] {
  font-size: 50%;
}

mjx-container [size="Tn"] {
  font-size: 60%;
}

mjx-container [size="sm"] {
  font-size: 85%;
}

mjx-container [size="lg"] {
  font-size: 120%;
}

mjx-container [size="Lg"] {
  font-size: 144%;
}

mjx-container [size="LG"] {
  font-size: 173%;
}

mjx-container [size="hg"] {
  font-size: 207%;
}

mjx-container [size="HG"] {
  font-size: 249%;
}

mjx-container [width="full"] {
  width: 100%;
}

mjx-box {
  display: inline-block;
}

mjx-block {
  display: block;
}

mjx-itable {
  display: inline-table;
}

mjx-row {
  display: table-row;
}

mjx-row > * {
  display: table-cell;
}

mjx-mtext {
  display: inline-block;
  text-align: left;
}

mjx-mstyle {
  display: inline-block;
}

mjx-merror {
  display: inline-block;
  color: red;
  background-color: yellow;
}

mjx-mphantom {
  visibility: hidden;
}

_::-webkit-full-page-media, _:future, :root mjx-container {
  will-change: opacity;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-math {
  display: inline-block;
  text-align: left;
  line-height: 0;
  text-indent: 0;
  font-style: normal;
  font-weight: normal;
  font-size: 100%;
  font-size-adjust: none;
  letter-spacing: normal;
  word-wrap: normal;
  word-spacing: normal;
  white-space: nowrap;
  direction: ltr;
  padding: 1px 0;
}

mjx-container[jax="CHTML"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="CHTML"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="CHTML"][display="true"] mjx-math {
  padding: 0;
}

mjx-container[jax="CHTML"][justify="left"] {
  text-align: left;
}

mjx-container[jax="CHTML"][justify="right"] {
  text-align: right;
}

mjx-mi {
  display: inline-block;
  text-align: left;
}

mjx-c {
  display: inline-block;
}

mjx-utext {
  display: inline-block;
  padding: .75em 0 .2em 0;
}

mjx-mn {
  display: inline-block;
  text-align: left;
}

mjx-TeXAtom {
  display: inline-block;
  text-align: left;
}

mjx-mo {
  display: inline-block;
  text-align: left;
}

mjx-stretchy-h {
  display: inline-table;
  width: 100%;
}

mjx-stretchy-h > * {
  display: table-cell;
  width: 0;
}

mjx-stretchy-h > * > mjx-c {
  display: inline-block;
  transform: scalex(1.0000001);
}

mjx-stretchy-h > * > mjx-c::before {
  display: inline-block;
  width: initial;
}

mjx-stretchy-h > mjx-ext {
  /* IE */ overflow: hidden;
  /* others */ overflow: clip visible;
  width: 100%;
}

mjx-stretchy-h > mjx-ext > mjx-c::before {
  transform: scalex(500);
}

mjx-stretchy-h > mjx-ext > mjx-c {
  width: 0;
}

mjx-stretchy-h > mjx-beg > mjx-c {
  margin-right: -.1em;
}

mjx-stretchy-h > mjx-end > mjx-c {
  margin-left: -.1em;
}

mjx-stretchy-v {
  display: inline-block;
}

mjx-stretchy-v > * {
  display: block;
}

mjx-stretchy-v > mjx-beg {
  height: 0;
}

mjx-stretchy-v > mjx-end > mjx-c {
  display: block;
}

mjx-stretchy-v > * > mjx-c {
  transform: scaley(1.0000001);
  transform-origin: left center;
  overflow: hidden;
}

mjx-stretchy-v > mjx-ext {
  display: block;
  height: 100%;
  box-sizing: border-box;
  border: 0px solid transparent;
  /* IE */ overflow: hidden;
  /* others */ overflow: visible clip;
}

mjx-stretchy-v > mjx-ext > mjx-c::before {
  width: initial;
  box-sizing: border-box;
}

mjx-stretchy-v > mjx-ext > mjx-c {
  transform: scaleY(500) translateY(.075em);
  overflow: visible;
}

mjx-mark {
  display: inline-block;
  height: 0px;
}

mjx-msub {
  display: inline-block;
  text-align: left;
}

mjx-mrow {
  display: inline-block;
  text-align: left;
}

mjx-msup {
  display: inline-block;
  text-align: left;
}

mjx-mspace {
  display: inline-block;
  text-align: left;
}

mjx-mtable {
  display: inline-block;
  text-align: center;
  vertical-align: .25em;
  position: relative;
  box-sizing: border-box;
  border-spacing: 0;
  border-collapse: collapse;
}

mjx-mstyle[size="s"] mjx-mtable {
  vertical-align: .354em;
}

mjx-labels {
  position: absolute;
  left: 0;
  top: 0;
}

mjx-table {
  display: inline-block;
  vertical-align: -.5ex;
  box-sizing: border-box;
}

mjx-table > mjx-itable {
  vertical-align: middle;
  text-align: left;
  box-sizing: border-box;
}

mjx-labels > mjx-itable {
  position: absolute;
  top: 0;
}

mjx-mtable[justify="left"] {
  text-align: left;
}

mjx-mtable[justify="right"] {
  text-align: right;
}

mjx-mtable[justify="left"][side="left"] {
  padding-right: 0 ! important;
}

mjx-mtable[justify="left"][side="right"] {
  padding-left: 0 ! important;
}

mjx-mtable[justify="right"][side="left"] {
  padding-right: 0 ! important;
}

mjx-mtable[justify="right"][side="right"] {
  padding-left: 0 ! important;
}

mjx-mtable[align] {
  vertical-align: baseline;
}

mjx-mtable[align="top"] > mjx-table {
  vertical-align: top;
}

mjx-mtable[align="bottom"] > mjx-table {
  vertical-align: bottom;
}

mjx-mtable[side="right"] mjx-labels {
  min-width: 100%;
}

mjx-mtr {
  display: table-row;
  text-align: left;
}

mjx-mtr[rowalign="top"] > mjx-mtd {
  vertical-align: top;
}

mjx-mtr[rowalign="center"] > mjx-mtd {
  vertical-align: middle;
}

mjx-mtr[rowalign="bottom"] > mjx-mtd {
  vertical-align: bottom;
}

mjx-mtr[rowalign="baseline"] > mjx-mtd {
  vertical-align: baseline;
}

mjx-mtr[rowalign="axis"] > mjx-mtd {
  vertical-align: .25em;
}

mjx-mtd {
  display: table-cell;
  text-align: center;
  padding: .215em .4em;
}

mjx-mtd:first-child {
  padding-left: 0;
}

mjx-mtd:last-child {
  padding-right: 0;
}

mjx-mtable > * > mjx-itable > *:first-child > mjx-mtd {
  padding-top: 0;
}

mjx-mtable > * > mjx-itable > *:last-child > mjx-mtd {
  padding-bottom: 0;
}

mjx-tstrut {
  display: inline-block;
  height: 1em;
  vertical-align: -.25em;
}

mjx-labels[align="left"] > mjx-mtr > mjx-mtd {
  text-align: left;
}

mjx-labels[align="right"] > mjx-mtr > mjx-mtd {
  text-align: right;
}

mjx-mtd[extra] {
  padding: 0;
}

mjx-mtd[rowalign="top"] {
  vertical-align: top;
}

mjx-mtd[rowalign="center"] {
  vertical-align: middle;
}

mjx-mtd[rowalign="bottom"] {
  vertical-align: bottom;
}

mjx-mtd[rowalign="baseline"] {
  vertical-align: baseline;
}

mjx-mtd[rowalign="axis"] {
  vertical-align: .25em;
}

mjx-mfrac {
  display: inline-block;
  text-align: left;
}

mjx-frac {
  display: inline-block;
  vertical-align: 0.17em;
  padding: 0 .22em;
}

mjx-frac[type="d"] {
  vertical-align: .04em;
}

mjx-frac[delims] {
  padding: 0 .1em;
}

mjx-frac[atop] {
  padding: 0 .12em;
}

mjx-frac[atop][delims] {
  padding: 0;
}

mjx-dtable {
  display: inline-table;
  width: 100%;
}

mjx-dtable > * {
  font-size: 2000%;
}

mjx-dbox {
  display: block;
  font-size: 5%;
}

mjx-num {
  display: block;
  text-align: center;
}

mjx-den {
  display: block;
  text-align: center;
}

mjx-mfrac[bevelled] > mjx-num {
  display: inline-block;
}

mjx-mfrac[bevelled] > mjx-den {
  display: inline-block;
}

mjx-den[align="right"], mjx-num[align="right"] {
  text-align: right;
}

mjx-den[align="left"], mjx-num[align="left"] {
  text-align: left;
}

mjx-nstrut {
  display: inline-block;
  height: .054em;
  width: 0;
  vertical-align: -.054em;
}

mjx-nstrut[type="d"] {
  height: .217em;
  vertical-align: -.217em;
}

mjx-dstrut {
  display: inline-block;
  height: .505em;
  width: 0;
}

mjx-dstrut[type="d"] {
  height: .726em;
}

mjx-line {
  display: block;
  box-sizing: border-box;
  min-height: 1px;
  height: .06em;
  border-top: .06em solid;
  margin: .06em -.1em;
  overflow: hidden;
}

mjx-line[type="d"] {
  margin: .18em -.1em;
}

mjx-c::before {
  display: block;
  width: 0;
}

.MJX-TEX {
  font-family: MJXZERO, MJXTEX;
}

.TEX-B {
  font-family: MJXZERO, MJXTEX-B;
}

.TEX-I {
  font-family: MJXZERO, MJXTEX-I;
}

.TEX-MI {
  font-family: MJXZERO, MJXTEX-MI;
}

.TEX-BI {
  font-family: MJXZERO, MJXTEX-BI;
}

.TEX-S1 {
  font-family: MJXZERO, MJXTEX-S1;
}

.TEX-S2 {
  font-family: MJXZERO, MJXTEX-S2;
}

.TEX-S3 {
  font-family: MJXZERO, MJXTEX-S3;
}

.TEX-S4 {
  font-family: MJXZERO, MJXTEX-S4;
}

.TEX-A {
  font-family: MJXZERO, MJXTEX-A;
}

.TEX-C {
  font-family: MJXZERO, MJXTEX-C;
}

.TEX-CB {
  font-family: MJXZERO, MJXTEX-CB;
}

.TEX-FR {
  font-family: MJXZERO, MJXTEX-FR;
}

.TEX-FRB {
  font-family: MJXZERO, MJXTEX-FRB;
}

.TEX-SS {
  font-family: MJXZERO, MJXTEX-SS;
}

.TEX-SSB {
  font-family: MJXZERO, MJXTEX-SSB;
}

.TEX-SSI {
  font-family: MJXZERO, MJXTEX-SSI;
}

.TEX-SC {
  font-family: MJXZERO, MJXTEX-SC;
}

.TEX-T {
  font-family: MJXZERO, MJXTEX-T;
}

.TEX-V {
  font-family: MJXZERO, MJXTEX-V;
}

.TEX-VB {
  font-family: MJXZERO, MJXTEX-VB;
}

mjx-stretchy-v mjx-c, mjx-stretchy-h mjx-c {
  font-family: MJXZERO, MJXTEX-S1, MJXTEX-S4, MJXTEX, MJXTEX-A ! important;
}

@font-face /* 0 */ {
  font-family: MJXZERO;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff");
}

@font-face /* 1 */ {
  font-family: MJXTEX;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff");
}

@font-face /* 2 */ {
  font-family: MJXTEX-B;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff");
}

@font-face /* 3 */ {
  font-family: MJXTEX-I;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff");
}

@font-face /* 4 */ {
  font-family: MJXTEX-MI;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff");
}

@font-face /* 5 */ {
  font-family: MJXTEX-BI;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff");
}

@font-face /* 6 */ {
  font-family: MJXTEX-S1;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff");
}

@font-face /* 7 */ {
  font-family: MJXTEX-S2;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff");
}

@font-face /* 8 */ {
  font-family: MJXTEX-S3;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff");
}

@font-face /* 9 */ {
  font-family: MJXTEX-S4;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff");
}

@font-face /* 10 */ {
  font-family: MJXTEX-A;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff");
}

@font-face /* 11 */ {
  font-family: MJXTEX-C;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff");
}

@font-face /* 12 */ {
  font-family: MJXTEX-CB;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff");
}

@font-face /* 13 */ {
  font-family: MJXTEX-FR;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff");
}

@font-face /* 14 */ {
  font-family: MJXTEX-FRB;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff");
}

@font-face /* 15 */ {
  font-family: MJXTEX-SS;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff");
}

@font-face /* 16 */ {
  font-family: MJXTEX-SSB;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff");
}

@font-face /* 17 */ {
  font-family: MJXTEX-SSI;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff");
}

@font-face /* 18 */ {
  font-family: MJXTEX-SC;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff");
}

@font-face /* 19 */ {
  font-family: MJXTEX-T;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff");
}

@font-face /* 20 */ {
  font-family: MJXTEX-V;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff");
}

@font-face /* 21 */ {
  font-family: MJXTEX-VB;
  src: url("https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff");
}

mjx-c.mjx-c1D45A.TEX-I::before {
  padding: 0.442em 0.878em 0.011em 0;
  content: "m";
}

mjx-c.mjx-c32::before {
  padding: 0.666em 0.5em 0 0;
  content: "2";
}

mjx-c.mjx-c1D70B.TEX-I::before {
  padding: 0.431em 0.57em 0.011em 0;
  content: "\3C0";
}

mjx-c.mjx-c1D45F.TEX-I::before {
  padding: 0.442em 0.451em 0.011em 0;
  content: "r";
}

mjx-c.mjx-c2F::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "/";
}

mjx-c.mjx-c2208::before {
  padding: 0.54em 0.667em 0.04em 0;
  content: "\2208";
}

mjx-c.mjx-c2115.TEX-A::before {
  padding: 0.683em 0.722em 0.02em 0;
  content: "N";
}

mjx-c.mjx-c1D446.TEX-I::before {
  padding: 0.705em 0.645em 0.022em 0;
  content: "S";
}

mjx-c.mjx-c3D::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "=";
}

mjx-c.mjx-c7B.TEX-S2::before {
  padding: 1.15em 0.667em 0.649em 0;
  content: "{";
}

mjx-c.mjx-c1D452.TEX-I::before {
  padding: 0.442em 0.466em 0.011em 0;
  content: "e";
}

mjx-c.mjx-c1D456.TEX-I::before {
  padding: 0.661em 0.345em 0.011em 0;
  content: "i";
}

mjx-c.mjx-c3A::before {
  padding: 0.43em 0.278em 0 0;
  content: ":";
}

mjx-c.mjx-c30::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "0";
}

mjx-c.mjx-c2C::before {
  padding: 0.121em 0.278em 0.194em 0;
  content: ",";
}

mjx-c.mjx-c31::before {
  padding: 0.666em 0.5em 0 0;
  content: "1";
}

mjx-c.mjx-c2026::before {
  padding: 0.12em 1.172em 0 0;
  content: "\2026";
}

mjx-c.mjx-c2212::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "\2212";
}

mjx-c.mjx-c7D.TEX-S2::before {
  padding: 1.15em 0.667em 0.649em 0;
  content: "}";
}

mjx-c.mjx-c2E::before {
  padding: 0.12em 0.278em 0 0;
  content: ".";
}

mjx-c.mjx-c28::before {
  padding: 0.75em 0.389em 0.25em 0;
  content: "(";
}

mjx-c.mjx-c6D::before {
  padding: 0.442em 0.833em 0 0;
  content: "m";
}

mjx-c.mjx-c6F::before {
  padding: 0.448em 0.5em 0.01em 0;
  content: "o";
}

mjx-c.mjx-c64::before {
  padding: 0.694em 0.556em 0.011em 0;
  content: "d";
}

mjx-c.mjx-c29::before {
  padding: 0.75em 0.389em 0.25em 0;
  content: ")";
}

mjx-c.mjx-c1D436.TEX-I::before {
  padding: 0.705em 0.76em 0.022em 0;
  content: "C";
}

mjx-c.mjx-c7B.TEX-S3::before {
  padding: 1.45em 0.75em 0.949em 0;
  content: "{";
}

mjx-c.mjx-c70::before {
  padding: 0.442em 0.556em 0.194em 0;
  content: "p";
}

mjx-c.mjx-c65::before {
  padding: 0.448em 0.444em 0.011em 0;
  content: "e";
}

mjx-c.mjx-c6E::before {
  padding: 0.442em 0.556em 0 0;
  content: "n";
}

mjx-c.mjx-c69::before {
  padding: 0.669em 0.278em 0 0;
  content: "i";
}

mjx-c.mjx-c66::before {
  padding: 0.705em 0.372em 0 0;
  content: "f";
}

mjx-c.mjx-cA0::before {
  padding: 0 0.25em 0 0;
  content: "\A0";
}

mjx-c.mjx-c67::before {
  padding: 0.453em 0.5em 0.206em 0;
  content: "g";
}

mjx-c.mjx-c63::before {
  padding: 0.448em 0.444em 0.011em 0;
  content: "c";
}

mjx-c.mjx-c62::before {
  padding: 0.694em 0.556em 0.011em 0;
  content: "b";
}

mjx-c.mjx-c6C::before {
  padding: 0.694em 0.278em 0 0;
  content: "l";
}

mjx-c.mjx-c6B::before {
  padding: 0.694em 0.528em 0 0;
  content: "k";
}

mjx-c.mjx-c74::before {
  padding: 0.615em 0.389em 0.01em 0;
  content: "t";
}

mjx-c.mjx-c68::before {
  padding: 0.694em 0.556em 0 0;
  content: "h";
}

mjx-c.mjx-c72::before {
  padding: 0.442em 0.392em 0 0;
  content: "r";
}

mjx-c.mjx-c77::before {
  padding: 0.431em 0.722em 0.011em 0;
  content: "w";
}

mjx-c.mjx-c73::before {
  padding: 0.448em 0.394em 0.011em 0;
  content: "s";
}

mjx-c.mjx-c1D711.TEX-I::before {
  padding: 0.442em 0.654em 0.218em 0;
  content: "\3C6";
}

mjx-c.mjx-c1D45D.TEX-I::before {
  padding: 0.442em 0.503em 0.194em 0;
  content: "p";
}

mjx-c.mjx-c7B::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "{";
}

mjx-c.mjx-c7D::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "}";
}

mjx-c.mjx-c2265::before {
  padding: 0.636em 0.778em 0.138em 0;
  content: "\2265";
}

mjx-c.mjx-c1D6FF.TEX-I::before {
  padding: 0.717em 0.444em 0.01em 0;
  content: "\3B4";
}

mjx-c.mjx-c2282::before {
  padding: 0.54em 0.778em 0.04em 0;
  content: "\2282";
}

mjx-c.mjx-c61::before {
  padding: 0.448em 0.5em 0.011em 0;
  content: "a";
}

mjx-c.mjx-c230A::before {
  padding: 0.75em 0.444em 0.25em 0;
  content: "\230A";
}

mjx-c.mjx-c230B::before {
  padding: 0.75em 0.444em 0.25em 0;
  content: "\230B";
}

mjx-c.mjx-c1D45B.TEX-I::before {
  padding: 0.442em 0.6em 0.011em 0;
  content: "n";
}

mjx-c.mjx-c7C::before {
  padding: 0.75em 0.278em 0.249em 0;
  content: "|";
}

mjx-c.mjx-c1D458.TEX-I::before {
  padding: 0.694em 0.521em 0.011em 0;
  content: "k";
}

mjx-c.mjx-c50::before {
  padding: 0.683em 0.681em 0 0;
  content: "P";
}

mjx-c.mjx-c2223::before {
  padding: 0.75em 0.278em 0.249em 0;
  content: "\2223";
}

mjx-c.mjx-c2248::before {
  padding: 0.483em 0.778em 0 0;
  content: "\2248";
}

mjx-c.mjx-c1D45E.TEX-I::before {
  padding: 0.442em 0.46em 0.194em 0;
  content: "q";
}

mjx-c.mjx-c2264::before {
  padding: 0.636em 0.778em 0.138em 0;
  content: "\2264";
}

mjx-c.mjx-c28.TEX-S2::before {
  padding: 1.15em 0.597em 0.649em 0;
  content: "(";
}

mjx-c.mjx-c29.TEX-S2::before {
  padding: 1.15em 0.597em 0.649em 0;
  content: ")";
}

mjx-c.mjx-c33::before {
  padding: 0.665em 0.5em 0.022em 0;
  content: "3";
}

mjx-c.mjx-c226B::before {
  padding: 0.567em 1em 0.067em 0;
  content: "\226B";
}

mjx-c.mjx-c1D700.TEX-I::before {
  padding: 0.452em 0.466em 0.022em 0;
  content: "\3B5";
}

mjx-c.mjx-c1D444.TEX-I::before {
  padding: 0.704em 0.791em 0.194em 0;
  content: "Q";
}

mjx-c.mjx-c2061::before {
  padding: 0 0 0 0;
  content: "";
}

mjx-c.mjx-c1D467.TEX-I::before {
  padding: 0.442em 0.465em 0.011em 0;
  content: "z";
}

mjx-c.mjx-c1D703.TEX-I::before {
  padding: 0.705em 0.469em 0.01em 0;
  content: "\3B8";
}

mjx-c.mjx-c5B.TEX-S3::before {
  padding: 1.45em 0.528em 0.949em 0;
  content: "[";
}

mjx-c.mjx-c2B::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "+";
}

mjx-c.mjx-c29.TEX-S3::before {
  padding: 1.45em 0.736em 0.949em 0;
  content: ")";
}

mjx-c.mjx-c3E::before {
  padding: 0.54em 0.778em 0.04em 0;
  content: ">";
}

mjx-c.mjx-c1D439.TEX-I::before {
  padding: 0.68em 0.749em 0 0;
  content: "F";
}

mjx-c.mjx-c20::before {
  padding: 0 0.25em 0 0;
  content: " ";
}

mjx-c.mjx-c75::before {
  padding: 0.442em 0.556em 0.011em 0;
  content: "u";
}

mjx-c.mjx-c79::before {
  padding: 0.431em 0.528em 0.204em 0;
  content: "y";
}

mjx-c.mjx-c43::before {
  padding: 0.705em 0.722em 0.021em 0;
  content: "C";
}

mjx-c.mjx-c1D445.TEX-I::before {
  padding: 0.683em 0.759em 0.021em 0;
  content: "R";
}

mjx-c.mjx-c1D43F.TEX-I::before {
  padding: 0.683em 0.681em 0 0;
  content: "L";
}

mjx-c.mjx-c28.TEX-S3::before {
  padding: 1.45em 0.736em 0.949em 0;
  content: "(";
}

mjx-c.mjx-c1D719.TEX-I::before {
  padding: 0.694em 0.596em 0.205em 0;
  content: "\3D5";
}

mjx-c.mjx-c1D449.TEX-I::before {
  padding: 0.683em 0.769em 0.022em 0;
  content: "V";
}

mjx-c.mjx-c1D70E.TEX-I::before {
  padding: 0.431em 0.571em 0.011em 0;
  content: "\3C3";
}

mjx-c.mjx-c1D707.TEX-I::before {
  padding: 0.442em 0.603em 0.216em 0;
  content: "\3BC";
}

mjx-c.mjx-c78::before {
  padding: 0.431em 0.528em 0 0;
  content: "x";
}

mjx-c.mjx-c2192::before {
  padding: 0.511em 1em 0.011em 0;
  content: "\2192";
}

mjx-c.mjx-c221E::before {
  padding: 0.442em 1em 0.011em 0;
  content: "\221E";
}

mjx-c.mjx-c1D6FD.TEX-I::before {
  padding: 0.705em 0.566em 0.194em 0;
  content: "\3B2";
}
</style><style>@keyframes slide-in-one-tap {
  from {
    transform: translateY(80px);
  }
  to {
    transform: translateY(0px);
  }
}

.trust-hide-gracefully {
  opacity: 0;
}

.trust-wallet-one-tap .hidden {
    display: none;
  }

.trust-wallet-one-tap .semibold {
    font-weight: 500;
  }

.trust-wallet-one-tap .binance-plex {
    font-family: 'Binance';
  }

.trust-wallet-one-tap .rounded-full {
    border-radius: 50%;
  }

.trust-wallet-one-tap .flex {
    display: flex;
  }

.trust-wallet-one-tap .flex-col {
    flex-direction: column;
  }

.trust-wallet-one-tap .items-center {
    align-items: center;
  }

.trust-wallet-one-tap .space-between {
    justify-content: space-between;
  }

.trust-wallet-one-tap .justify-center {
    justify-content: center;
  }

.trust-wallet-one-tap .w-full {
    width: 100%;
  }

.trust-wallet-one-tap .box {
    transition: all 0.5s cubic-bezier(0, 0, 0, 1.43);
    animation: slide-in-one-tap 0.5s cubic-bezier(0, 0, 0, 1.43);
    width: 384px;
    border-radius: 15px;
    background: #fff;
    box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.25);
    position: fixed;
    right: 30px;
    bottom: 30px;
    z-index: 1020;
  }

.trust-wallet-one-tap .header {
    gap: 15px;
    border-bottom: 1px solid #e6e6e6;
    padding: 10px 18px;
  }

.trust-wallet-one-tap .header .left-items {
      gap: 15px;
    }

.trust-wallet-one-tap .header .title {
      color: #1e2329;
      font-size: 18px;
      font-weight: 600;
      line-height: 28px;
    }

.trust-wallet-one-tap .header .subtitle {
      color: #474d57;
      font-size: 14px;
      line-height: 20px;
    }

.trust-wallet-one-tap .header .close {
      color: #1e2329;
      cursor: pointer;
    }

.trust-wallet-one-tap .body {
    padding: 9px 18px;
    gap: 10px;
  }

.trust-wallet-one-tap .body .right-items {
      gap: 10px;
      width: 100%;
    }

.trust-wallet-one-tap .body .right-items .wallet-title {
        color: #1e2329;
        font-size: 16px;
        font-weight: 600;
        line-height: 20px;
      }

.trust-wallet-one-tap .body .right-items .wallet-subtitle {
        color: #474d57;
        font-size: 14px;
        line-height: 20px;
      }

.trust-wallet-one-tap .connect-indicator {
    gap: 15px;
    padding: 8px 0;
  }

.trust-wallet-one-tap .connect-indicator .flow-icon {
      color: #474d57;
    }

.trust-wallet-one-tap .loading-color {
    color: #fff;
  }

.trust-wallet-one-tap .button {
    border-radius: 50px;
    outline: 2px solid transparent;
    outline-offset: 2px;
    background-color: rgb(5, 0, 255);
    border-color: rgb(229, 231, 235);
    cursor: pointer;
    text-align: center;
    height: 45px;
  }

.trust-wallet-one-tap .button .button-text {
      color: #fff;
      font-size: 16px;
      font-weight: 600;
      line-height: 20px;
    }

.trust-wallet-one-tap .footer {
    margin: 20px 30px;
  }

.trust-wallet-one-tap .check-icon {
    color: #fff;
  }

@font-face {
  font-family: 'Binance';
  src: url(chrome-extension://egjidjbpglichdcondbcbdnbeeppgdph/fonts/BinancePlex-Regular.otf) format('opentype');
  font-weight: 400;
  font-style: normal;
}

@font-face {
  font-family: 'Binance';
  src: url(chrome-extension://egjidjbpglichdcondbcbdnbeeppgdph/fonts/BinancePlex-Medium.otf) format('opentype');
  font-weight: 500;
  font-style: normal;
}

@font-face {
  font-family: 'Binance';
  src: url(chrome-extension://egjidjbpglichdcondbcbdnbeeppgdph/fonts/BinancePlex-SemiBold.otf) format('opentype');
  font-weight: 600;
  font-style: normal;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL2FwcC9zcmMvb25lVGFwL3N0eWxlLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFO0lBQ0UsMkJBQTJCO0VBQzdCO0VBQ0E7SUFDRSwwQkFBMEI7RUFDNUI7QUFDRjs7QUFFQTtFQUNFLFVBQVU7QUFDWjs7QUFHRTtJQUNFLGFBQWE7RUFDZjs7QUFFQTtJQUNFLGdCQUFnQjtFQUNsQjs7QUFFQTtJQUNFLHNCQUFzQjtFQUN4Qjs7QUFFQTtJQUNFLGtCQUFrQjtFQUNwQjs7QUFFQTtJQUNFLGFBQWE7RUFDZjs7QUFFQTtJQUNFLHNCQUFzQjtFQUN4Qjs7QUFFQTtJQUNFLG1CQUFtQjtFQUNyQjs7QUFFQTtJQUNFLDhCQUE4QjtFQUNoQzs7QUFFQTtJQUNFLHVCQUF1QjtFQUN6Qjs7QUFFQTtJQUNFLFdBQVc7RUFDYjs7QUFFQTtJQUNFLGdEQUFnRDtJQUNoRCw0REFBNEQ7SUFDNUQsWUFBWTtJQUNaLG1CQUFtQjtJQUNuQixnQkFBZ0I7SUFDaEIsK0NBQStDO0lBQy9DLGVBQWU7SUFDZixXQUFXO0lBQ1gsWUFBWTtJQUNaLGFBQWE7RUFDZjs7QUFFQTtJQUNFLFNBQVM7SUFDVCxnQ0FBZ0M7SUFDaEMsa0JBQWtCO0VBdUJwQjs7QUFyQkU7TUFDRSxTQUFTO0lBQ1g7O0FBRUE7TUFDRSxjQUFjO01BQ2QsZUFBZTtNQUNmLGdCQUFnQjtNQUNoQixpQkFBaUI7SUFDbkI7O0FBRUE7TUFDRSxjQUFjO01BQ2QsZUFBZTtNQUNmLGlCQUFpQjtJQUNuQjs7QUFFQTtNQUNFLGNBQWM7TUFDZCxlQUFlO0lBQ2pCOztBQUdGO0lBQ0UsaUJBQWlCO0lBQ2pCLFNBQVM7RUFtQlg7O0FBakJFO01BQ0UsU0FBUztNQUNULFdBQVc7SUFjYjs7QUFaRTtRQUNFLGNBQWM7UUFDZCxlQUFlO1FBQ2YsZ0JBQWdCO1FBQ2hCLGlCQUFpQjtNQUNuQjs7QUFFQTtRQUNFLGNBQWM7UUFDZCxlQUFlO1FBQ2YsaUJBQWlCO01BQ25COztBQUlKO0lBQ0UsU0FBUztJQUNULGNBQWM7RUFLaEI7O0FBSEU7TUFDRSxjQUFjO0lBQ2hCOztBQUdGO0lBQ0UsV0FBVztFQUNiOztBQUVBO0lBQ0UsbUJBQW1CO0lBQ25CLDhCQUE4QjtJQUM5QixtQkFBbUI7SUFDbkIsZ0NBQWdDO0lBQ2hDLGdDQUFnQztJQUNoQyxlQUFlO0lBQ2Ysa0JBQWtCO0lBQ2xCLFlBQVk7RUFRZDs7QUFORTtNQUNFLFdBQVc7TUFDWCxlQUFlO01BQ2YsZ0JBQWdCO01BQ2hCLGlCQUFpQjtJQUNuQjs7QUFHRjtJQUNFLGlCQUFpQjtFQUNuQjs7QUFFQTtJQUNFLFdBQVc7RUFDYjs7QUFHRjtFQUNFLHNCQUFzQjtFQUN0QiwrREFBMEU7RUFDMUUsZ0JBQWdCO0VBQ2hCLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLHNCQUFzQjtFQUN0QiwrREFBeUU7RUFDekUsZ0JBQWdCO0VBQ2hCLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLHNCQUFzQjtFQUN0QiwrREFBMkU7RUFDM0UsZ0JBQWdCO0VBQ2hCLGtCQUFrQjtBQUNwQiIsInNvdXJjZXNDb250ZW50IjpbIkBrZXlmcmFtZXMgc2xpZGUtaW4tb25lLXRhcCB7XG4gIGZyb20ge1xuICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSg4MHB4KTtcbiAgfVxuICB0byB7XG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDBweCk7XG4gIH1cbn1cblxuLnRydXN0LWhpZGUtZ3JhY2VmdWxseSB7XG4gIG9wYWNpdHk6IDA7XG59XG5cbi50cnVzdC13YWxsZXQtb25lLXRhcCB7XG4gIC5oaWRkZW4ge1xuICAgIGRpc3BsYXk6IG5vbmU7XG4gIH1cblxuICAuc2VtaWJvbGQge1xuICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG4gIH1cblxuICAuYmluYW5jZS1wbGV4IHtcbiAgICBmb250LWZhbWlseTogJ0JpbmFuY2UnO1xuICB9XG5cbiAgLnJvdW5kZWQtZnVsbCB7XG4gICAgYm9yZGVyLXJhZGl1czogNTAlO1xuICB9XG5cbiAgLmZsZXgge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gIH1cblxuICAuZmxleC1jb2wge1xuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIH1cblxuICAuaXRlbXMtY2VudGVyIHtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICB9XG5cbiAgLnNwYWNlLWJldHdlZW4ge1xuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgfVxuXG4gIC5qdXN0aWZ5LWNlbnRlciB7XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gIH1cblxuICAudy1mdWxsIHtcbiAgICB3aWR0aDogMTAwJTtcbiAgfVxuXG4gIC5ib3gge1xuICAgIHRyYW5zaXRpb246IGFsbCAwLjVzIGN1YmljLWJlemllcigwLCAwLCAwLCAxLjQzKTtcbiAgICBhbmltYXRpb246IHNsaWRlLWluLW9uZS10YXAgMC41cyBjdWJpYy1iZXppZXIoMCwgMCwgMCwgMS40Myk7XG4gICAgd2lkdGg6IDM4NHB4O1xuICAgIGJvcmRlci1yYWRpdXM6IDE1cHg7XG4gICAgYmFja2dyb3VuZDogI2ZmZjtcbiAgICBib3gtc2hhZG93OiAwcHggMnB4IDRweCAwcHggcmdiYSgwLCAwLCAwLCAwLjI1KTtcbiAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgcmlnaHQ6IDMwcHg7XG4gICAgYm90dG9tOiAzMHB4O1xuICAgIHotaW5kZXg6IDEwMjA7XG4gIH1cblxuICAuaGVhZGVyIHtcbiAgICBnYXA6IDE1cHg7XG4gICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlNmU2ZTY7XG4gICAgcGFkZGluZzogMTBweCAxOHB4O1xuXG4gICAgLmxlZnQtaXRlbXMge1xuICAgICAgZ2FwOiAxNXB4O1xuICAgIH1cblxuICAgIC50aXRsZSB7XG4gICAgICBjb2xvcjogIzFlMjMyOTtcbiAgICAgIGZvbnQtc2l6ZTogMThweDtcbiAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7XG4gICAgICBsaW5lLWhlaWdodDogMjhweDtcbiAgICB9XG5cbiAgICAuc3VidGl0bGUge1xuICAgICAgY29sb3I6ICM0NzRkNTc7XG4gICAgICBmb250LXNpemU6IDE0cHg7XG4gICAgICBsaW5lLWhlaWdodDogMjBweDtcbiAgICB9XG5cbiAgICAuY2xvc2Uge1xuICAgICAgY29sb3I6ICMxZTIzMjk7XG4gICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgfVxuICB9XG5cbiAgLmJvZHkge1xuICAgIHBhZGRpbmc6IDlweCAxOHB4O1xuICAgIGdhcDogMTBweDtcblxuICAgIC5yaWdodC1pdGVtcyB7XG4gICAgICBnYXA6IDEwcHg7XG4gICAgICB3aWR0aDogMTAwJTtcblxuICAgICAgLndhbGxldC10aXRsZSB7XG4gICAgICAgIGNvbG9yOiAjMWUyMzI5O1xuICAgICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7XG4gICAgICAgIGxpbmUtaGVpZ2h0OiAyMHB4O1xuICAgICAgfVxuXG4gICAgICAud2FsbGV0LXN1YnRpdGxlIHtcbiAgICAgICAgY29sb3I6ICM0NzRkNTc7XG4gICAgICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgICAgICAgbGluZS1oZWlnaHQ6IDIwcHg7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLmNvbm5lY3QtaW5kaWNhdG9yIHtcbiAgICBnYXA6IDE1cHg7XG4gICAgcGFkZGluZzogOHB4IDA7XG5cbiAgICAuZmxvdy1pY29uIHtcbiAgICAgIGNvbG9yOiAjNDc0ZDU3O1xuICAgIH1cbiAgfVxuXG4gIC5sb2FkaW5nLWNvbG9yIHtcbiAgICBjb2xvcjogI2ZmZjtcbiAgfVxuXG4gIC5idXR0b24ge1xuICAgIGJvcmRlci1yYWRpdXM6IDUwcHg7XG4gICAgb3V0bGluZTogMnB4IHNvbGlkIHRyYW5zcGFyZW50O1xuICAgIG91dGxpbmUtb2Zmc2V0OiAycHg7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDUsIDAsIDI1NSk7XG4gICAgYm9yZGVyLWNvbG9yOiByZ2IoMjI5LCAyMzEsIDIzNSk7XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICBoZWlnaHQ6IDQ1cHg7XG5cbiAgICAuYnV0dG9uLXRleHQge1xuICAgICAgY29sb3I6ICNmZmY7XG4gICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgICBmb250LXdlaWdodDogNjAwO1xuICAgICAgbGluZS1oZWlnaHQ6IDIwcHg7XG4gICAgfVxuICB9XG5cbiAgLmZvb3RlciB7XG4gICAgbWFyZ2luOiAyMHB4IDMwcHg7XG4gIH1cblxuICAuY2hlY2staWNvbiB7XG4gICAgY29sb3I6ICNmZmY7XG4gIH1cbn1cblxuQGZvbnQtZmFjZSB7XG4gIGZvbnQtZmFtaWx5OiAnQmluYW5jZSc7XG4gIHNyYzogdXJsKCcuL2ZvbnRzL2JpbmFuY2VQbGV4L0JpbmFuY2VQbGV4LVJlZ3VsYXIub3RmJykgZm9ybWF0KCdvcGVudHlwZScpO1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LXN0eWxlOiBub3JtYWw7XG59XG5cbkBmb250LWZhY2Uge1xuICBmb250LWZhbWlseTogJ0JpbmFuY2UnO1xuICBzcmM6IHVybCgnLi9mb250cy9iaW5hbmNlUGxleC9CaW5hbmNlUGxleC1NZWRpdW0ub3RmJykgZm9ybWF0KCdvcGVudHlwZScpO1xuICBmb250LXdlaWdodDogNTAwO1xuICBmb250LXN0eWxlOiBub3JtYWw7XG59XG5cbkBmb250LWZhY2Uge1xuICBmb250LWZhbWlseTogJ0JpbmFuY2UnO1xuICBzcmM6IHVybCgnLi9mb250cy9iaW5hbmNlUGxleC9CaW5hbmNlUGxleC1TZW1pQm9sZC5vdGYnKSBmb3JtYXQoJ29wZW50eXBlJyk7XG4gIGZvbnQtd2VpZ2h0OiA2MDA7XG4gIGZvbnQtc3R5bGU6IG5vcm1hbDtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */</style></head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="https://wessengetachew.github.io/Farey/">Farey</a></h1>
      

      <p>&lt;!DOCTYPE html&gt;</p>


    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nested Farey Channels &amp; Fractional-Slice Coprimality - Wessen Getachew</title>
    <script src="./Farey _ Farey_files/tex-mml-chtml.min.js.download"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Palatino Linotype', 'Book Antiqua', Palatino, serif;
            line-height: 1.6;
            color: #2c3e50;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .paper-container {
            max-width: 1100px;
            margin: 0 auto;
            background: white;
            padding: 60px 80px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            border-radius: 4px;
        }

        header {
            text-align: center;
            margin-bottom: 50px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 30px;
        }

        h1 {
            font-size: 2.2em;
            font-weight: 700;
            color: #1a252f;
            margin-bottom: 20px;
            letter-spacing: 0.5px;
        }

        .author {
            font-size: 1.3em;
            font-style: italic;
            color: #555;
            margin-bottom: 10px;
        }

        .date {
            font-size: 1em;
            color: #777;
        }

        .section-title {
            font-size: 1.7em;
            font-weight: 600;
            color: #2c3e50;
            margin-top: 45px;
            margin-bottom: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .subsection-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #34495e;
            margin-top: 35px;
            margin-bottom: 15px;
        }

        p {
            text-align: justify;
            margin-bottom: 15px;
            font-size: 1.05em;
        }

        .definition, .proposition, .theorem, .proof, .corollary, .lemma, .algorithm {
            margin: 25px 0;
            padding: 20px;
            border-radius: 6px;
            position: relative;
        }

        .definition {
            background: linear-gradient(135deg, #e8f4f8 0%, #d4e7f0 100%);
            border-left: 5px solid #3498db;
        }

        .proposition, .theorem, .corollary {
            background: linear-gradient(135deg, #f0f7ef 0%, #e1f0dd 100%);
            border-left: 5px solid #27ae60;
        }

        .lemma {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            border-left: 5px solid #ff9800;
        }

        .algorithm {
            background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);
            border-left: 5px solid #9c27b0;
        }

        .proof {
            background: linear-gradient(135deg, #fef5e7 0%, #fdebd0 100%);
            border-left: 5px solid #f39c12;
        }

        .label {
            font-weight: 700;
            font-size: 1.1em;
            color: #2c3e50;
            margin-bottom: 10px;
            display: block;
        }

        .proof-end {
            float: right;
            font-size: 1.3em;
            font-weight: bold;
        }

        ul {
            margin-left: 30px;
            margin-bottom: 20px;
        }

        li {
            margin-bottom: 12px;
            font-size: 1.05em;
        }

        .canvas-container {
            margin: 30px 0;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 35px;
            border-radius: 12px;
            border: 2px solid #667eea;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        canvas {
            border: 2px solid #495057;
            background: white;
            border-radius: 8px;
            cursor: crosshair;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            display: block;
            margin: 0 auto;
        }

        .controls {
            margin-top: 25px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            align-items: center;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
            background: white;
            padding: 10px 15px;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        label {
            font-weight: 600;
            color: #495057;
            font-size: 0.95em;
        }

        input[type="number"], input[type="range"] {
            padding: 8px 12px;
            border: 2px solid #ced4da;
            border-radius: 6px;
            font-size: 1em;
            width: 100px;
            transition: border-color 0.3s;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
        }

        select {
            padding: 8px 12px;
            border: 2px solid #ced4da;
            border-radius: 6px;
            font-size: 0.95em;
            cursor: pointer;
        }

        button {
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 0.95em;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }

        button.secondary {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
        }

        button.success {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }

        button.danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .caption {
            font-style: italic;
            color: #666;
            margin-top: 20px;
            font-size: 0.95em;
            text-align: center;
        }

        .abstract {
            background: linear-gradient(135deg, #ecf0f1 0%, #d5dbdb 100%);
            padding: 30px;
            margin: 30px 0;
            border-radius: 8px;
            font-style: italic;
            border-left: 5px solid #95a5a6;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .info-box {
            background: linear-gradient(135deg, #fff3cd 0%, #ffe69c 100%);
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
        }

        .info-box strong {
            color: #856404;
        }

        .stats-display {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 2px solid #667eea;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            font-weight: 600;
            color: #495057;
        }

        .stat-value {
            color: #667eea;
            font-weight: 700;
        }

        .test-result {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            font-weight: 600;
        }

        .test-result.pass {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }

        .test-result.fail {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        pre {
            background: white;
            color: #2c3e50;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
            border: 2px solid #dee2e6;
        }

        .experimental-section {
            background: #f8f9fa;
            padding: 30px;
            margin: 30px 0;
            border-radius: 8px;
            border: 2px solid #667eea;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .results-history {
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            border: 2px solid #667eea;
            border-radius: 8px;
            background: white;
        }

        .result-item {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
            cursor: pointer;
            transition: background 0.2s;
        }

        .result-item:hover {
            background: #f8f9fa;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .result-title {
            font-weight: 600;
            color: #2c3e50;
        }

        .result-time {
            font-size: 0.85em;
            color: #95a5a6;
        }

        .result-summary {
            font-size: 0.95em;
            color: #666;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .collapsed-details {
            display: none;
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
        }

        .result-item.expanded .collapsed-details {
            display: block;
        }

        input[type="checkbox"] {
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        @media (max-width: 768px) {
            .paper-container {
                padding: 30px 20px;
            }

            h1 {
                font-size: 1.8em;
            }

            canvas {
                max-width: 100%;
                height: auto;
            }

            .controls {
                flex-direction: column;
            }

            .control-group {
                width: 100%;
            }
        }
    </style>


    <div class="paper-container">
        <header>
            <h1>Nested Farey Channels &amp; Fractional-Slice Coprimality Heuristic</h1>
            <div class="author">Wessen Getachew</div>
            <div class="date">October 2025</div>
            

<div style="text-align: center; margin-top: 12px; font-size: 0.9em;">
                <span style="opacity: 0.8;">Explore more prime visualizations:</span>
                <a href="https://wessengetachew.github.io/GCD/" target="_blank" style="color: #4ecdc4; text-decoration: none; margin: 0 8px; font-weight: 500;">GCD Patterns</a>
                <span style="opacity: 0.5;">|</span>
                <a href="https://wessengetachew.github.io/Primes/" target="_blank" style="color: #4ecdc4; text-decoration: none; margin: 0 8px; font-weight: 500;">Prime Spirals</a>
<span style="opacity: 0.5;">|</span>
                <a href="https://wessengetachew.github.io/Ethiopian/" target="_blank" style="color: #4ecdc4; text-decoration: none; margin: 0 8px; font-weight: 500;">Epsilon Pi Calculator</a>
            </div>
        </header>

        <div class="abstract">
            <strong>Abstract.</strong> We introduce the <em>Nested Farey Channel Framework</em>, a geometric representation of modular arithmetic on the unit circle, and develop two complementary heuristics for primality analysis. The <em>Fractional-Slice Coprimality Heuristic</em> provides rapid probabilistic prime detection by sampling coprime residues within restricted circular arcs, while the <em>Chord Length Uniformity Heuristic</em> offers an independent geometric signature based on inter-residue spacing. Each modulus <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="0" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container> maps to <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="1" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container> equidistant points at angles <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="2" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi></mi><mi>r</mi><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mi>m</mi></math></mjx-assistive-mml></mjx-container>. Prime moduli exhibit maximal channel openness and uniform chord distributions, while composites show blocked Farey channels and irregular spacing. Extensive empirical validation across n  [3, 10,000] reveals separation increasing from 32.7% to 92.3%, demonstrating robust scalability and asymptotic optimality. We prove formal bounds, derive decision thresholds, and provide interactive demonstrations with publication-quality visualizations featuring 10 coloring schemes and 4K export capabilities.
        </div>

        <div class="section-title">Part I: Nested Farey Channels Framework</div>

        <div class="definition">
            <span class="label">Definition 1.1 (Channel Rings).</span>
            For a modulus <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="3" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-mi class="mjx-ds mjx-b"><mjx-c class="mjx-c2115 TEX-A"></mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo></mo><mrow data-mjx-texclass="ORD"><mi mathvariant="double-struck">N</mi></mrow></math></mjx-assistive-mml></mjx-container>, define the ring
            <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="4" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.032em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-lop"><mjx-c class="mjx-c7B TEX-S2"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em;"><mjx-texatom size="s" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-lop"><mjx-c class="mjx-c7D TEX-S2"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>S</mi><mi>m</mi></msub><mo>=</mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">{</mo><msup><mi>e</mi><mrow data-mjx-texclass="ORD"><mn>2</mn><mi></mi><mi>i</mi><mi>r</mi><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mi>m</mi></mrow></msup><mo>:</mo><mi>r</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mo></mo><mo>,</mo><mi>m</mi><mo></mo><mn>1</mn><mo data-mjx-texclass="CLOSE">}</mo></mrow><mo>.</mo></math></mjx-assistive-mml></mjx-container>
            Each element corresponds to a residue class <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="5" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mspace style="width: 0.444em;"></mjx-mspace><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mspace style="width: 0.333em;"></mjx-mspace><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mspace width="0.444em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>m</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container> visualized on the unit circle.
        </div>

        <div class="definition">
            <span class="label">Definition 1.2 (Open and Blocked Channels).</span>
            A channel <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="6" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.045em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mrow data-mjx-texclass="ORD"><mi>r</mi><mo>,</mo><mi>m</mi></mrow></msub></math></mjx-assistive-mml></mjx-container> is said to be:
            <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="7" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.045em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-s3"><mjx-c class="mjx-c7B TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 11.748em;"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: left; padding-right: 0.5em; padding-bottom: 0.1em;"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c6E"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-bottom: 0.1em;"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: left; padding-right: 0.5em; padding-top: 0.1em;"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c62"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c6B"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.1em;"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c68"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c77"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c2E"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n" style="vertical-align: 0.25em;"></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>C</mi><mrow data-mjx-texclass="ORD"><mi>r</mi><mo>,</mo><mi>m</mi></mrow></msub><mo>=</mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">{</mo><mtable columnalign="left left" columnspacing="1em" rowspacing=".2em"><mtr><mtd><mtext>open</mtext><mo>,</mo></mtd><mtd><mtext>if&nbsp;</mtext><mo data-mjx-texclass="OP" movablelimits="true">gcd</mo><mo stretchy="false">(</mo><mi>r</mi><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>,</mo></mtd></mtr><mtr><mtd><mtext>blocked</mtext><mo>,</mo></mtd><mtd><mtext>otherwise.</mtext></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"></mo></mrow></math></mjx-assistive-mml></mjx-container>
            The set of open channels has cardinality <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="8" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D711 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi></mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>, Euler's totient function.
        </div>

        <div class="proposition">
            <span class="label">Proposition 1.3 (Prime Channel Completeness).</span>
            <em>For a prime modulus <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="9" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></mjx-assistive-mml></mjx-container>, every residue <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="10" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo></mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo></mo><mo>,</mo><mi>p</mi><mo></mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container> satisfies <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="11" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo data-mjx-texclass="OP" movablelimits="true">gcd</mo><mo stretchy="false">(</mo><mi>r</mi><mo>,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container>. Thus <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="12" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.032em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>p</mi></msub></math></mjx-assistive-mml></mjx-container> forms a maximally open ring with <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="13" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D711 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi></mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo></mo><mn>1</mn></math></mjx-assistive-mml></mjx-container> open channels and a single blocked channel at <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="14" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mn>0</mn></math></mjx-assistive-mml></mjx-container>.</em>
        </div>

        <div class="canvas-container">
            <canvas id="channelCanvas" width="700" height="700"></canvas>
            <div class="controls">
                <div class="control-group">
                    <label for="modInput">Modulus:</label>
                    <input type="number" id="modInput" value="13" min="2" max="500">
                </div>
                <button onclick="drawChannelRing()">Visualize</button>
                <button class="secondary" onclick="toggleChannelLabels()">Toggle Labels</button>
            </div>
            <div class="stats-display" id="channelStats" style="display: block;">
                <div class="stat-row"><span class="stat-label">Modulus:</span><span class="stat-value">13</span></div>
                <div class="stat-row"><span class="stat-label">Open Channels:</span><span class="stat-value">12</span></div>
                <div class="stat-row"><span class="stat-label">Blocked Channels:</span><span class="stat-value">0</span></div>
                <div class="stat-row"><span class="stat-label">Density (m):</span><span class="stat-value">0.9231</span></div>
                <div class="stat-row"><span class="stat-label">Is Prime:</span><span class="stat-value">Yes </span></div>
            </div>
            <div class="caption">Figure 1: Channel ring visualization showing open (green) and blocked (red) channels</div>
        </div>

        <div class="section-title">Part II: Fractional-Slice Coprimality Heuristic</div>

        <div class="subsection-title">2.1 Heuristic Definition</div>

        <p>For any modulus <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="15" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2265"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo></mo><mn>2</mn></math></mjx-assistive-mml></mjx-container>, define the <em>coprime density</em></p>
        <p style="text-align: center;">
        <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="16" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FF TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D711 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi></mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi></mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><mi>m</mi></mfrac><mo>,</mo></math></mjx-assistive-mml></mjx-container>
        </p>
        <p>the fraction of residues mod <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="17" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container> that are coprime to <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="18" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container>. For a prime <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="19" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></mjx-assistive-mml></mjx-container>, this equals <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="20" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FF TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mfrac space="3"><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi></mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo></mo><mfrac><mn>1</mn><mi>p</mi></mfrac></math></mjx-assistive-mml></mjx-container>.</p>

        <div class="definition">
            <span class="label">Definition 2.1 (Fractional Slice).</span>
            Let <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="21" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2282"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo></mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo></mo><mo>,</mo><mi>m</mi><mo></mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container> denote a chosen sampling region, such as the half-circle
            <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="22" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.032em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c68"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c66"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c230A"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c230B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>S</mi><mrow data-mjx-texclass="ORD"><mtext>half</mtext></mrow></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mo></mo><mo>,</mo><mo fence="false" stretchy="false"></mo><mi>m</mi><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mn>2</mn><mo fence="false" stretchy="false"></mo><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container>
            or a one-<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="23" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container>th slice of residues distributed over <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="24" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70B TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi></mi><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mi>n</mi></math></mjx-assistive-mml></mjx-container> radians. The slice captures a geometric subset of the modular ring. Define
            <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="25" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FF TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-mstyle><mjx-mspace style="width: 0.167em;"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo><mjx-mstyle><mjx-mspace style="width: 0.167em;"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi></mi><mi>S</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mo stretchy="false">|</mo><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mo fence="false" stretchy="false">{</mo><mi>r</mi><mo></mo><mi>S</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo><mo data-mjx-texclass="OP" movablelimits="true">gcd</mo><mo stretchy="false">(</mo><mi>r</mi><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mo stretchy="false">|</mo></mrow><mrow><mo stretchy="false">|</mo><mi>S</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">|</mo></mrow></mfrac></math></mjx-assistive-mml></mjx-container>
            as the local coprime density within that slice.
        </div>

        <div class="algorithm">
            <span class="label">Sampling Rule.</span>
            Sample <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="26" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container> residues <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="27" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mn>1</mn></msub><mo>,</mo><mo></mo><mo>,</mo><msub><mi>r</mi><mi>k</mi></msub></math></mjx-assistive-mml></mjx-container> uniformly from <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="28" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>. If every sampled residue satisfies <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="29" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo data-mjx-texclass="OP" movablelimits="true">gcd</mo><mo stretchy="false">(</mo><msub><mi>r</mi><mi>i</mi></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container>, declare <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="30" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container> a <em>prime candidate</em> under the fractional-slice test.
        </div>

        <div class="subsection-title">2.2 Probabilistic Bound</div>

        <p>Assuming independent sampling, the probability of a composite <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="31" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container> passing the test is approximately</p>
        <p style="text-align: center;">
        <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="32" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mo class="mjx-n"><mjx-c class="mjx-c50"></mjx-c><mjx-c class="mjx-c72"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mtext class="mjx-n"><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mtext><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2223"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2248"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FF TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.413em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo data-mjx-texclass="OP" movablelimits="true">Pr</mo><mo stretchy="false">(</mo><mtext>pass</mtext><mo></mo><mi>m</mi><mo stretchy="false">)</mo><mo></mo><msub><mi></mi><mi>S</mi></msub><mo stretchy="false">(</mo><mi>m</mi><msup><mo stretchy="false">)</mo><mi>k</mi></msup><mo>.</mo></math></mjx-assistive-mml></mjx-container>
        </p>

        <div class="proposition">
            <span class="label">Proposition 2.2 (Fractional-Slice Coprimality Bound).</span>
            <em>Let <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="33" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2265"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo></mo><mn>2</mn></math></mjx-assistive-mml></mjx-container> and let <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="34" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2282"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo></mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mo></mo><mo>,</mo><mi>m</mi><mo></mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container> be a fixed sampling subset of size <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="35" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">|</mo><mi>S</mi><mo stretchy="false">|</mo></math></mjx-assistive-mml></mjx-container>. If a random residue <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="36" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo></mo><mi>S</mi></math></mjx-assistive-mml></mjx-container> is coprime to <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="37" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container> with probability <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="38" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FF TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi></mi><mi>S</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>, then for <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="39" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container> independent samples (with replacement),</em>
            <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="40" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mo class="mjx-n"><mjx-c class="mjx-c50"></mjx-c><mjx-c class="mjx-c72"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mtext class="mjx-n"><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mtext><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2223"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FF TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.413em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo data-mjx-texclass="OP" movablelimits="true">Pr</mo><mo stretchy="false">(</mo><mtext>pass</mtext><mo></mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi></mi><mi>S</mi></msub><mo stretchy="false">(</mo><mi>m</mi><msup><mo stretchy="false">)</mo><mi>k</mi></msup><mo>.</mo></math></mjx-assistive-mml></mjx-container>
            <em>If <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="41" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></mjx-assistive-mml></mjx-container> is the smallest prime factor of <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="42" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container>, then</em>
            <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="43" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mo class="mjx-n"><mjx-c class="mjx-c50"></mjx-c><mjx-c class="mjx-c72"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mtext class="mjx-n"><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mtext><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2223"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-mo class="mjx-lop"><mjx-c class="mjx-c28 TEX-S2"></mjx-c></mjx-mo></mjx-texatom><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mfrac space="3"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-msup><mjx-texatom texclass="ORD"><mjx-mo class="mjx-lop"><mjx-c class="mjx-c29 TEX-S2"></mjx-c></mjx-mo></mjx-texatom><mjx-script style="vertical-align: 0.877em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo data-mjx-texclass="OP" movablelimits="true">Pr</mo><mo stretchy="false">(</mo><mtext>pass</mtext><mo></mo><mi>m</mi><mo stretchy="false">)</mo><mo></mo><mrow data-mjx-texclass="ORD"><mo minsize="1.623em" maxsize="1.623em">(</mo></mrow><mn>1</mn><mo></mo><mfrac><mn>1</mn><mi>q</mi></mfrac><msup><mrow data-mjx-texclass="ORD"><mo minsize="1.623em" maxsize="1.623em">)</mo></mrow><mi>k</mi></msup><mo>.</mo></math></mjx-assistive-mml></mjx-container>
        </div>

        <p>This yields the following key behavior:</p>
        <ul>
            <li>For even composites (<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="44" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo>=</mo><mn>2</mn></math></mjx-assistive-mml></mjx-container>): <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="45" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c50"></mjx-c><mjx-c class="mjx-c72"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mtext class="mjx-n"><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo data-mjx-texclass="OP" movablelimits="true">Pr</mo><mo stretchy="false">(</mo><mtext>pass</mtext><mo stretchy="false">)</mo><mo></mo><mo stretchy="false">(</mo><mn>1</mn><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mn>2</mn><msup><mo stretchy="false">)</mo><mi>k</mi></msup></math></mjx-assistive-mml></mjx-container></li>
            <li>For <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="46" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c33"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo>=</mo><mn>3</mn></math></mjx-assistive-mml></mjx-container>: <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="47" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c50"></mjx-c><mjx-c class="mjx-c72"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mtext class="mjx-n"><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo data-mjx-texclass="OP" movablelimits="true">Pr</mo><mo stretchy="false">(</mo><mtext>pass</mtext><mo stretchy="false">)</mo><mo></mo><mo stretchy="false">(</mo><mn>2</mn><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mn>3</mn><msup><mo stretchy="false">)</mo><mi>k</mi></msup></math></mjx-assistive-mml></mjx-container></li>
            <li>For semiprimes with large factors (<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="48" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c226B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo></mo><mn>1</mn></math></mjx-assistive-mml></mjx-container>): the bound weakens, requiring larger <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="49" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container></li>
        </ul>

        <p>Thus the heuristic strongly rejects composites with small factors, and becomes probabilistically weaker only for products of large primes.</p>

        <div class="subsection-title">2.3 Slice Dependence and Symmetry</div>

        <div class="proposition">
            <span class="label">Proposition 2.3 (Half-Circle Neutrality).</span>
            <em>For the half-circle slice, mirror symmetry ensures</em>
            <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="50" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FF TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c68"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c66"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D6FF TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi></mi><mrow data-mjx-texclass="ORD"><mtext>half</mtext></mrow></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mi></mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>,</mo></math></mjx-assistive-mml></mjx-container>
            <em>since <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="51" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo data-mjx-texclass="OP" movablelimits="true">gcd</mo><mo stretchy="false">(</mo><mi>r</mi><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mo data-mjx-texclass="OP" movablelimits="true">gcd</mo><mo stretchy="false">(</mo><mi>m</mi><mo></mo><mi>r</mi><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>. Hence the half-circle is a neutral choice that avoids residue bias.</em>
        </div>

        <div class="section-title">3. Interactive Algorithm Demonstration</div>

        <div class="info-box">
            <strong>Test the Heuristic:</strong> Enter a modulus, choose sampling parameters, and watch the fractional-slice algorithm in action. The visualization shows which residues are tested and whether they pass the coprimality check.
        </div>

        <div class="experimental-section">
            <h3 style="color: #667eea; margin-bottom: 20px;" id="fractional-slice-coprimality-test">Fractional-Slice Coprimality Test<a class="anchorjs-link " href="https://wessengetachew.github.io/Farey/#fractional-slice-coprimality-test" aria-label="Anchor" data-anchorjs-icon="" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
            
            <div class="controls" style="margin-bottom: 20px;">
                <div class="control-group">
                    <label for="testModulus">Test Modulus:</label>
                    <input type="number" id="testModulus" value="91" min="2" max="10000">
                </div>
                <div class="control-group">
                    <label for="sampleCount">Samples (k):</label>
                    <input type="number" id="sampleCount" value="5" min="1" max="50">
                </div>
                <div class="control-group">
                    <label for="sliceType">Slice Type:</label>
                    <select id="sliceType">
                        <option value="half">Half-Circle</option>
                        <option value="quarter">Quarter-Circle</option>
                        <option value="full">Full Circle</option>
                    </select>
                </div>
                <button class="success" onclick="runFractionalTest()">Run Test</button>
                <button class="secondary" onclick="runBatchTest()">Batch Test (10 runs)</button>
            </div>

            <canvas id="testCanvas" width="600" height="600" style="display: block; margin: 20px auto;"></canvas>
            
            <div id="testResult">
                <div class="test-result fail">
                    <strong>Result:</strong> FAIL  - 91 is composite (detected)
                </div>
                <div class="stats-display" style="margin-top: 15px;">
                    <div class="stat-row"><span class="stat-label">Modulus:</span><span class="stat-value">91</span></div>
                    <div class="stat-row"><span class="stat-label">Actual Status:</span><span class="stat-value">Composite</span></div>
                    <div class="stat-row"><span class="stat-label">Samples Tested:</span><span class="stat-value">5</span></div>
                    <div class="stat-row"><span class="stat-label">Passed Samples:</span><span class="stat-value">4/5</span></div>
                    <div class="stat-row"><span class="stat-label">Smallest Factor:</span><span class="stat-value">7</span></div>
                    <div class="stat-row"><span class="stat-label">Theoretical Pass Prob:</span><span class="stat-value">0.4627</span></div>
                </div>
            </div>
            <div id="batchResults"></div>

            <div class="export-buttons">
                <button class="secondary" onclick="exportTestScreenshot()"> Export Screenshot</button>
                <button class="secondary" onclick="exportTestData(&#39;json&#39;)"> Export JSON</button>
                <button class="secondary" onclick="exportTestData(&#39;csv&#39;)"> Export CSV</button>
                <button class="secondary" onclick="clearTestHistory()"> Clear History</button>
            </div>

            <div id="testHistory" style="display: block;">
                <h4 style="color: #667eea; margin: 20px 0 10px 0;" id="test-history">Test History<a class="anchorjs-link " href="https://wessengetachew.github.io/Farey/#test-history" aria-label="Anchor" data-anchorjs-icon="" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h4>
                <div class="results-history" id="testHistoryList">
                <div class="result-item" onclick="toggleResultDetails(0)">
                    <div class="result-header">
                        <span class="result-title">Single Test: m=91, k=5</span>
                        <span class="result-time">11/8/2025, 5:32:14 AM</span>
                    </div>
                    <div class="result-summary">
                        Result: PASS  | 
                        Composite | 
                        Density: 0.7912
                    </div>
                    <div class="collapsed-details">
                        <strong>Details:</strong><br>
                        Samples: 5/5<br>
                        Smallest Factor: 7<br>
                        Theoretical Prob: 0.4627<br>
                        Slice Type: half
                    </div>
                </div>
            </div>
            </div>
        </div>

        <div class="section-title">4. Algorithmic Formulation</div>

        <div class="algorithm">
            <span class="label">Algorithm 4.1 (Deterministic + Randomized Hybrid Filter).</span>
            <pre>function is_prime_candidate(m, k, slice="half", 
                           small_primes=[2,3,5,7,11,13]):
    // (1) Deterministic prefilter by small primes
    for q in small_primes:
        if m % q == 0 and m != q:
            return False
    
    // (2) Choose slice
    if slice == "half":
        S = {1, 2, ..., floor(m/2)}
    else if slice == "quarter":
        S = {1, 2, ..., floor(m/4)}
    else:
        S = {1, 2, ..., m-1}
    
    // (3) Random sampling
    for i in 1..k:
        r = random_choice(S)
        if gcd(r, m) != 1:
            return False
    
    return True  // passes fractional-slice test
</pre>
        </div>

        <p>The parameter <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="52" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container> governs tradeoff between false-positive rate and computational cost. For a target false positive probability <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="53" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D700 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi></mi></math></mjx-assistive-mml></mjx-container> and smallest divisor threshold <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="54" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D444 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></mjx-assistive-mml></mjx-container>, choose</p>
        <p style="text-align: center;">
        <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="55" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2265"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D700 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D444 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>k</mi><mo></mo><mfrac><mrow><mi>log</mi><mo data-mjx-texclass="NONE"></mo><mi></mi></mrow><mrow><mi>log</mi><mo data-mjx-texclass="NONE"></mo><mo stretchy="false">(</mo><mn>1</mn><mo></mo><mn>1</mn><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mi>Q</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>.</mo></math></mjx-assistive-mml></mjx-container>
        </p>

        <div class="section-title">5. Experimental Evaluation</div>

        <div class="experimental-section">
            <h3 style="color: #667eea; margin-bottom: 20px;" id="large-scale-empirical-testing">Large-Scale Empirical Testing<a class="anchorjs-link " href="https://wessengetachew.github.io/Farey/#large-scale-empirical-testing" aria-label="Anchor" data-anchorjs-icon="" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
            
            <div class="controls" style="margin-bottom: 20px;">
                <div class="control-group">
                    <label for="rangeStart">Range Start:</label>
                    <input type="number" id="rangeStart" value="100" min="2">
                </div>
                <div class="control-group">
                    <label for="rangeEnd">Range End:</label>
                    <input type="number" id="rangeEnd" value="500" min="2">
                </div>
                <div class="control-group">
                    <label for="expSamples">Samples (k):</label>
                    <input type="number" id="expSamples" value="10" min="1" max="50">
                </div>
                <button class="success" onclick="runExperiment()">Run Experiment</button>
            </div>

            <div class="progress-bar" id="progressBar" style="display: none;">
                <div class="progress-fill" id="progressFill">0%</div>
            </div>

            <div id="experimentResults"></div>
        </div>

        <div class="section-title">6. Geometric Interpretation and Concentric Rings</div>

        <p>The fractional-slice heuristic can be visualized in two complementary ways: on the unit circle, and as a 2D plane of concentric rings.</p>

        <div class="subsection-title">6.1 Unit Circle Representation</div>

        <p>Map each residue <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="56" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo></mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo></mo><mo>,</mo><mi>m</mi><mo></mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container> to the point</p>
        <p style="text-align: center;">
        <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="57" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em;"><mjx-texatom size="s" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>z</mi><mi>r</mi></msub><mo>=</mo><msup><mi>e</mi><mrow data-mjx-texclass="ORD"><mn>2</mn><mi></mi><mi>i</mi><mi>r</mi><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mi>m</mi></mrow></msup><mo>.</mo></math></mjx-assistive-mml></mjx-container>
        </p>
        <p>Coprime residues lie on "open channels" that avoid blocked directions determined by the factors of <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="58" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container>.</p>

        <div class="definition">
            <span class="label">Angular Slices.</span>
            Selecting a subset <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="59" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container> of size <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="60" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">|</mo><mi>S</mi><mo stretchy="false">|</mo></math></mjx-assistive-mml></mjx-container> corresponds to choosing an arc
            <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="61" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5B TEX-S3"></mjx-c></mjx-mo><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70B TEX-I"></mjx-c></mjx-mi><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mfrac space="2"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-s3"><mjx-c class="mjx-c29 TEX-S3"></mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi></mi><mo></mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mfrac><mrow><mn>2</mn><mi></mi><msub><mi>r</mi><mn>0</mn></msub></mrow><mi>m</mi></mfrac><mo>,</mo><mfrac><mrow><mn>2</mn><mi></mi><mo stretchy="false">(</mo><msub><mi>r</mi><mn>0</mn></msub><mo>+</mo><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>S</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">)</mo></mrow><mi>m</mi></mfrac><mo data-mjx-texclass="CLOSE">)</mo></mrow></math></mjx-assistive-mml></mjx-container>
            on the unit circle.
            <ul style="margin-top: 10px;">
                <li>Half-circle: <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="62" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c230A"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c230B"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">|</mo><mi>S</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mo fence="false" stretchy="false"></mo><mi>m</mi><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mn>2</mn><mo fence="false" stretchy="false"></mo></math></mjx-assistive-mml></mjx-container>, spanning <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="63" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi></mi></math></mjx-assistive-mml></mjx-container> radians.</li>
                <li>One-<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="64" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container>th slice: <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="65" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c230A"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c230B"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">|</mo><mi>S</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mo fence="false" stretchy="false"></mo><mi>m</mi><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mi>n</mi><mo fence="false" stretchy="false"></mo></math></mjx-assistive-mml></mjx-container>, spanning <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="66" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70B TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi></mi><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mi>n</mi></math></mjx-assistive-mml></mjx-container> radians.</li>
            </ul>
        </div>

        <p>Blocked Farey channels appear as gaps along the arc where <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="67" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo data-mjx-texclass="OP" movablelimits="true">gcd</mo><mo stretchy="false">(</mo><mi>r</mi><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container>. Prime moduli maximize the fraction of occupied (coprime) points in every slice; composites produce visible voids aligned with their divisors.</p>

        <div class="remarks">
            <strong>Farey Sequence Connection:</strong> Positions of blocked residues correspond to fractions <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="68" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mi>m</mi></math></mjx-assistive-mml></mjx-container> reducible to lower terms, forming a subset of the Farey sequence <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="69" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.106em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>F</mi><mi>m</mi></msub></math></mjx-assistive-mml></mjx-container>. Partial sampling of the circle thus samples a fractional Farey subsequence, producing a geometric signature for primality.
        </div>

        <div class="subsection-title">6.2 Concentric Ring Visualization</div>

        <p>The unit circle can be extended to a 2D plane of concentric rings to capture the nested structure of residues for multiple moduli.</p>

        <ul>
            <li>Let each ring correspond to a modulus <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="70" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container>.</li>
            <li>Place the points <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="71" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em;"><mjx-texatom size="s" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mi>r</mi></msub><mo>=</mo><msup><mi>e</mi><mrow data-mjx-texclass="ORD"><mn>2</mn><mi></mi><mi>i</mi><mi>r</mi><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mi>m</mi></mrow></msup></math></mjx-assistive-mml></mjx-container> on the ring of radius proportional to <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="72" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container>.</li>
            <li>Coprime residues are marked (filled dots), blocked residues are shown differently.</li>
        </ul>

        <div class="canvas-container">
            <h3 style="color: #667eea; margin-bottom: 20px; text-align: center;" id="concentric-rings-nested-farey-structure">Concentric Rings: Nested Farey Structure<a class="anchorjs-link " href="https://wessengetachew.github.io/Farey/#concentric-rings-nested-farey-structure" aria-label="Anchor" data-anchorjs-icon="" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
            <div style="text-align: center; margin-bottom: 15px;">
                <span style="color: #666; font-weight: 600;">Resolution: </span>
                <button class="mode-btn" onclick="setConcentricResolution(1920)">HD</button>
                <button class="mode-btn" onclick="setConcentricResolution(2560)">2K</button>
                <button class="mode-btn active" onclick="setConcentricResolution(3840)">4K</button>
            </div>
            <canvas id="concentricCanvas" width="3840" height="3840" style="max-width: 100%; height: auto;"></canvas>
            
            <div class="controls">
                <div class="control-group">
                    <label for="minMod">Min Modulus:</label>
                    <input type="number" id="minMod" value="1" min="1" max="200">
                </div>
                <div class="control-group">
                    <label for="maxMod">Max Modulus:</label>
                    <input type="number" id="maxMod" value="100" min="1" max="200">
                </div>
                <div class="control-group">
                    <label for="pointSize">Point Size:</label>
                    <input type="range" id="pointSize" min="1" max="10" value="2" step="0.5" style="width: 100px;">
                    <span id="pointSizeVal">2</span>px
                </div>
                <div class="control-group">
                    <label>
                        <input type="checkbox" id="invertRings">
                        Invert (OuterInner)
                    </label>
                </div>
                <div class="control-group">
                    <label>
                        <input type="checkbox" id="concentricDarkBg">
                        Black Background
                    </label>
                </div>
            </div>

            <div class="controls" style="margin-top: 10px;">
                <div class="control-group">
                    <label for="globalRotation">Global Rotation:</label>
                    <input type="range" id="globalRotation" min="0" max="360" value="0" step="1" style="width: 150px;">
                    <span id="globalRotationVal">0</span>
                </div>
                <div class="control-group">
                    <label for="localRotation">Local Rotation:</label>
                    <input type="range" id="localRotation" min="0" max="360" value="0" step="1" style="width: 150px;">
                    <span id="localRotationVal">0</span>
                </div>
                <div class="control-group">
                    <label for="individualRotation">Individual m Rotation:</label>
                    <input type="range" id="individualRotation" min="0" max="360" value="0" step="1" style="width: 150px;">
                    <span id="individualRotationVal">0</span>
                </div>
            </div>

            <div class="controls" style="margin-top: 10px;">
                <div class="control-group">
                    <label for="trackResidue">Track r:</label>
                    <input type="number" id="trackResidue" value="1" min="1" max="200">
                </div>
                <div class="control-group">
                    <label>
                        <input type="checkbox" id="showAllR" checked="">
                        Show All r
                    </label>
                </div>
                <div class="control-group">
                    <label>
                        <input type="checkbox" id="highlightTracked" checked="">
                        Highlight Tracked r
                    </label>
                </div>
            </div>

            <div class="controls" style="margin-top: 10px;">
                <div class="control-group">
                    <label for="ringMode">Display Mode:</label>
                    <select id="ringMode" onchange="updateModeControls()">
                        <option value="all">All Residues</option>
                        <option value="open-only">Open Channels Only</option>
                        <option value="primes-only">Primes Only</option>
                        <option value="fixed-r">Fixed r (vary m)</option>
                        <option value="fixed-m">Fixed m (vary r)</option>
                        <option value="multi-r">Multiple r values</option>
                        <option value="multi-m">Multiple m values</option>
                    </select>
                </div>
                <div class="control-group" id="fixedRGroup" style="display: none;">
                    <label for="fixedRValue">r value:</label>
                    <input type="number" id="fixedRValue" value="1" min="1" max="100">
                </div>
                <div class="control-group" id="fixedMGroup" style="display: none;">
                    <label for="fixedMValue">m value:</label>
                    <input type="number" id="fixedMValue" value="12" min="2" max="200">
                </div>
                <div class="control-group" id="multiRGroup" style="display: none; flex-direction: column; align-items: flex-start; min-width: 300px;">
                    <label style="margin-bottom: 5px;">Select r values:</label>
                    <input type="text" id="multiRValues" placeholder="e.g. 1,2,3,5,7 or primes or composites" style="width: 100%; margin-bottom: 5px;">
                    <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                        <button class="secondary" onclick="setMultiR(&#39;primes&#39;)" style="padding: 5px 10px; font-size: 0.9em;">Primes 20</button>
                        <button class="secondary" onclick="setMultiR(&#39;composites&#39;)" style="padding: 5px 10px; font-size: 0.9em;">Composites 20</button>
                        <button class="secondary" onclick="setMultiR(&#39;powers2&#39;)" style="padding: 5px 10px; font-size: 0.9em;">Powers of 2</button>
                        <button class="secondary" onclick="setMultiR(&#39;powers3&#39;)" style="padding: 5px 10px; font-size: 0.9em;">Powers of 3</button>
                    </div>
                </div>
                <div class="control-group" id="multiMGroup" style="display: none; flex-direction: column; align-items: flex-start; min-width: 300px;">
                    <label style="margin-bottom: 5px;">Select m values:</label>
                    <input type="text" id="multiMValues" placeholder="e.g. 12,15,20,30 or primes or composites" style="width: 100%; margin-bottom: 5px;">
                    <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                        <button class="secondary" onclick="setMultiM(&#39;primes&#39;)" style="padding: 5px 10px; font-size: 0.9em;">Primes 30</button>
                        <button class="secondary" onclick="setMultiM(&#39;composites&#39;)" style="padding: 5px 10px; font-size: 0.9em;">Composites 30</button>
                        <button class="secondary" onclick="setMultiM(&#39;fibonacci&#39;)" style="padding: 5px 10px; font-size: 0.9em;">Fibonacci</button>
                        <button class="secondary" onclick="setMultiM(&#39;highly-composite&#39;)" style="padding: 5px 10px; font-size: 0.9em;">Highly Composite</button>
                    </div>
                </div>
            </div>

            <div class="controls" style="margin-top: 10px;">
                <div class="control-group">
                    <label for="colorMode">Color Mode:</label>
                    <select id="colorMode" onchange="updateColorModeInfo()">
                        <option value="open-blocked">1. Binary: Open vs Blocked</option>
                        <option value="gcd-gradient">2. GCD Gradient</option>
                        <option value="gcd-local">3. GCD (Local per m)</option>
                        <option value="gcd-global">4. GCD (Global)</option>
                        <option value="prime-factor">5. Smallest Prime Factor</option>
                        <option value="density-local">6. Local Density Gradient</option>
                        <option value="residue-class">7. Residue Class mod k</option>
                        <option value="farey-level">8. Farey Denominator Level</option>
                        <option value="angular-hue">9. Angular Hue</option>
                        <option value="multi-property">10. Multi-Property (HSB)</option>
                    </select>
                </div>
                <div class="control-group" id="residueClassGroup" style="display: none;">
                    <label for="residueK">mod k:</label>
                    <input type="number" id="residueK" value="3" min="2" max="12">
                </div>
                <div id="colorModeInfo" style="margin-top: 5px; font-size: 0.85em; color: #666; font-style: italic;">Hue=angle, Saturation=gcd, Brightness=slice</div>
            </div>

            <div class="controls" style="margin-top: 15px;">
                <strong style="color: #495057;">Visibility:</strong>
                <label style="display: inline-flex; align-items: center; margin-left: 15px;">
                    <input type="checkbox" id="showRings" checked="" style="margin-right: 5px;">
                    Ring Lines
                </label>
                <label style="display: inline-flex; align-items: center; margin-left: 15px;">
                    <input type="checkbox" id="showLabels" checked="" style="margin-right: 5px;">
                    Modulus Labels
                </label>
                <label style="display: inline-flex; align-items: center; margin-left: 15px;">
                    <input type="checkbox" id="showAxes" checked="" style="margin-right: 5px;">
                    Axes
                </label>
                <label style="display: inline-flex; align-items: center; margin-left: 15px;">
                    <input type="checkbox" id="showLegend" checked="" style="margin-right: 5px;">
                    Legend
                </label>
            </div>

            <div class="controls" style="margin-top: 15px; padding: 15px; background: rgba(39, 174, 96, 0.1); border-radius: 8px; border: 2px solid rgba(39, 174, 96, 0.3);">
                <strong style="color: #27ae60;">GCD=1 Labels:</strong>
                <label style="display: inline-flex; align-items: center; margin-left: 15px;">
                    <input type="checkbox" id="showGCD1Labels" onchange="updateGCD1LabelControls()" style="margin-right: 5px;">
                    Show Labels on Coprime Points
                </label>
                
                <div id="gcd1LabelControls" style="display: block; margin-top: 10px; margin-left: 15px; padding-left: 15px; border-left: 3px solid rgb(39, 174, 96);">
                    <div style="display: flex; gap: 20px; flex-wrap: wrap; align-items: center;">
                        <div class="control-group">
                            <label for="labelType">Label Type:</label>
                            <select id="labelType" style="min-width: 150px;">
                                <option value="r-value">r value</option>
                                <option value="gcd-value">gcd value (always 1)</option>
                                <option value="mod-value">Modulus (m)</option>
                                <option value="farey">Farey fraction (r/m)</option>
                                <option value="theta-deg">Angle  (degrees)</option>
                                <option value="theta-rad">Angle  (radians)</option>
                                <option value="both-rm">Both (r,m)</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label for="labelFontSize">Size:</label>
                            <input type="range" id="labelFontSize" min="6" max="24" value="10" step="1" style="width: 100px;">
                            <span id="labelFontSizeVal">24</span>px
                        </div>
                        <div class="control-group">
                            <label for="labelColor">Color:</label>
                            <select id="labelColor">
                                <option value="auto">Auto (adapt)</option>
                                <option value="white">White</option>
                                <option value="black">Black</option>
                                <option value="green">Green</option>
                                <option value="blue">Blue</option>
                                <option value="cyan">Cyan</option>
                                <option value="yellow">Yellow</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>
                                <input type="checkbox" id="hideGCD1Dots">
                                Hide Dots (labels only)
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="controls" style="margin-top: 15px;">
                <button onclick="drawConcentricRings()">Visualize</button>
                <button class="success" onclick="exportConcentricWithLegend(&#39;4k&#39;)"> Export 4K + Legend</button>
                <button class="success" onclick="exportConcentricWithLegend(&#39;2k&#39;)"> Export 2K + Legend</button>
                <button class="secondary" onclick="exportConcentricView()"> Simple Export</button>
            </div>
            
            <div class="stats-display" id="concentricStats" style="margin-top: 20px;"></div>
            <div class="caption">Figure 2: Concentric rings showing nested Farey channel structure across multiple moduli</div>
        </div>

        <div class="remarks">
            <strong>Interpretation:</strong>
            <ul>
                <li>Each ring shows the local coprimality pattern for a single modulus.</li>
                <li>Nested rings reveal how Farey channels propagate across successive moduli.</li>
                <li>Angular gaps (blocked channels) align radially, illustrating the "nested" property: blocked residues of smaller divisors project outward to higher moduli.</li>
            </ul>
        </div>

        <div class="proposition">
            <span class="label">Visualization Principle.</span>
            <em>By combining angular slices on the unit circle with concentric rings in 2D, we obtain a comprehensive geometric view:</em>
            <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="73" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c50"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c3A"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c79"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mtext><mjx-mstyle><mjx-mspace style="width: 1em;"></mjx-mspace></mjx-mstyle><mjx-mstyle><mjx-mspace style="width: 1em;"></mjx-mspace></mjx-mstyle><mjx-mtext class="mjx-n"><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c3A"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c77"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c68"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c2E"></mjx-c></mjx-mtext></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Prime moduli: full occupancy along slices and rings</mtext><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mtext>Composite moduli: radial gaps aligned with factors.</mtext></math></mjx-assistive-mml></mjx-container>
            <em>This representation underlies the fractional-slice heuristic and provides visual intuition for why primes maintain maximal channel openness, even when sampling only a fraction of the residues.</em>
        </div>

        <div class="section-title">8. Chord Length Uniformity Analysis</div>

        <p>Beyond fractional-slice sampling, we can analyze the <strong>geometric uniformity</strong> of coprime residues by measuring chord lengths between consecutive points on the unit circle. This provides an independent geometric signature for primality.</p>

        <div class="definition">
            <span class="label">Chord Length.</span>
            For consecutive coprime residues <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="74" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo></mo><msub><mi>R</mi><mi>n</mi></msub></math></mjx-assistive-mml></mjx-container>, the Euclidean chord length on the unit circle is:
            <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="75" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mrow space="2"><mjx-mo class="mjx-s3"><mjx-c class="mjx-c28 TEX-S3"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70B TEX-I"></mjx-c></mjx-mi><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-s3"><mjx-c class="mjx-c29 TEX-S3"></mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><mn>2</mn><mi>sin</mi><mo data-mjx-texclass="NONE"></mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mi></mi><mfrac><mrow><msub><mi>r</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo></mo><msub><mi>r</mi><mi>i</mi></msub></mrow><mi>n</mi></mfrac><mo data-mjx-texclass="CLOSE">)</mo></mrow></math></mjx-assistive-mml></mjx-container>
            with wrap-around chord <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="76" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.177em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D719 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mrow space="2"><mjx-mo class="mjx-lop"><mjx-c class="mjx-c28 TEX-S2"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70B TEX-I"></mjx-c></mjx-mi><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.177em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D719 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msub></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-lop"><mjx-c class="mjx-c29 TEX-S2"></mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mrow data-mjx-texclass="ORD"><mi></mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><mn>2</mn><mi>sin</mi><mo data-mjx-texclass="NONE"></mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mi></mi><mfrac><mrow><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><mi>n</mi><mo></mo><msub><mi>r</mi><mrow data-mjx-texclass="ORD"><mi></mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msub></mrow><mi>n</mi></mfrac><mo data-mjx-texclass="CLOSE">)</mo></mrow></math></mjx-assistive-mml></mjx-container>.
        </div>

        <div class="proposition">
            <span class="label">Proposition 8.1 (Chord Uniformity Heuristic).</span>
            <em>Prime moduli produce more uniform chord length distributions than composite moduli.</em>
            
            <p style="margin-top: 10px;"><strong>Quantification:</strong> Define the coefficient of variation
            <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="77" style="font-size: 113.1%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D707 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mi>V</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><msub><mi></mi><mi>L</mi></msub><msub><mi></mi><mi>L</mi></msub></mfrac></math></mjx-assistive-mml></mjx-container>
            where <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="78" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi></mi><mi>L</mi></msub></math></mjx-assistive-mml></mjx-container> is the standard deviation and <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="79" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D707 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi></mi><mi>L</mi></msub></math></mjx-assistive-mml></mjx-container> is the mean of all chord lengths.
            </p>
            
            <p style="margin-top: 10px;"><strong>Empirical Results:</strong> Extensive validation across multiple ranges:
            </p>
            <table style="width: 100%; margin: 15px 0; border-collapse: collapse; background: white;">
                <thead>
                    <tr style="background: #667eea; color: white;">
                        <th style="padding: 10px; border: 1px solid #dee2e6;">Range</th>
                        <th style="padding: 10px; border: 1px solid #dee2e6;">Prime Avg CV</th>
                        <th style="padding: 10px; border: 1px solid #dee2e6;">Composite Avg CV</th>
                        <th style="padding: 10px; border: 1px solid #dee2e6;">Separation</th>
                        <th style="padding: 10px; border: 1px solid #dee2e6;">Significance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">n  50</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">0.183</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">0.272</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: #27ae60;">32.7%</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">p &lt; 0.001</td>
                    </tr>
                    <tr style="background: #f8f9fa;">
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">n  100</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">0.155</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">0.297</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: #27ae60;">47.6%</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">p &lt; 0.001</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">n  500</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">0.086</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">0.307</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: #27ae60;">71.9%</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">p &lt; 0.0001</td>
                    </tr>
                    <tr style="background: #f8f9fa;">
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">n  1,000</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">0.065</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">0.304</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: #27ae60;">78.7%</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">p &lt; 0.0001</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">n  10,000</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">0.022</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">0.292</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: #667eea;">92.3%</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; text-align: center;">p &lt; 0.0001</td>
                    </tr>
                </tbody>
            </table>
            <p style="margin-top: 10px;"><strong>Key Findings:</strong></p>
            <ul>
                <li><strong>Monotonic Increase:</strong> Separation grows from 32.7% to 92.3% as range increases</li>
                <li><strong>Asymptotic Behavior:</strong> Prime CV  0 while composite CV remains ~0.3</li>
                <li><strong>Perfect Recall:</strong> 100% detection rate for primes (0 false negatives)</li>
                <li><strong>Scalability:</strong> Tested feasibly up to n=10,000; practical to n=100,000+</li>
            </ul>
        </div>

        <div class="remarks">
            <strong>Geometric Interpretation:</strong> Primes distribute coprime residues nearly uniformly around the circle, producing consistent chord lengths. Composites create clustering (dense regions) and gaps (sparse regions), increasing chord length variance. The gap ratio <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="80" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c78"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo data-mjx-texclass="OP" movablelimits="true">max</mo><mo stretchy="false">(</mo><msub><mi>L</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mo data-mjx-texclass="OP" movablelimits="true">min</mo><mo stretchy="false">(</mo><msub><mi>L</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container> also distinguishes primes (avg 1.87) from composites (avg 2.02).
            
            <p style="margin-top: 10px;"><strong>Extended Validation:</strong> Testing up to n=10,000 reveals that separation <em>increases monotonically</em> with range, suggesting asymptotic optimality: as <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="81" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2192"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="4"><mjx-c class="mjx-c221E"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo accent="false" stretchy="false"></mo><mi mathvariant="normal"></mi></math></mjx-assistive-mml></mjx-container>, <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="82" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.186em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c65"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2192"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><msub><mi>V</mi><mrow data-mjx-texclass="ORD"><mtext>prime</mtext></mrow></msub><mo accent="false" stretchy="false"></mo><mn>0</mn></math></mjx-assistive-mml></mjx-container> while <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="83" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.186em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c70"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><msub><mi>V</mi><mrow data-mjx-texclass="ORD"><mtext>comp</mtext></mrow></msub></math></mjx-assistive-mml></mjx-container> remains bounded near 0.3, implying theoretical separation approaching 100%.</p>
        </div>

        <div class="canvas-container">
            <h3 style="color: #667eea; margin-bottom: 20px; text-align: center;" id="chord-length-analysis">Chord Length Analysis<a class="anchorjs-link " href="https://wessengetachew.github.io/Farey/#chord-length-analysis" aria-label="Anchor" data-anchorjs-icon="" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
            <canvas id="chordCanvas" width="800" height="400"></canvas>
            <div class="controls">
                <div class="control-group">
                    <label for="chordModulus">Test Modulus n:</label>
                    <input type="number" id="chordModulus" value="17" min="3" max="200">
                </div>
                <button onclick="analyzeChordLengths()">Analyze</button>
                <button class="secondary" onclick="compareChordDistributions()">Compare Prime vs Composite</button>
            </div>
            <div id="chordResults" style="margin-top: 20px;"></div>
            <div class="caption">Figure 3: Chord length distribution reveals geometric uniformity  primes show lower variance</div>
        </div>

        <div class="algorithm">
            <strong>Algorithm 8.1 (Chord Uniformity Test).</strong>
            <pre style="background: white; color: #2c3e50;">1. Input: modulus n
2. Compute coprime residues R_n = {r : gcd(r,n)=1, 1r&lt;n}
3. For each consecutive pair (r_i, r_{i+1}):
     L_i = 2sin((r_{i+1}-r_i)/n)
4. Compute statistics:
     _L = mean(L_i)
     _L = std_dev(L_i)
     CV = _L / _L
     gap_ratio = max(L_i) / min(L_i)
5. Decision thresholds (range-dependent):
     For n  100:    CV &lt; 0.22  likely prime
     For n  500:    CV &lt; 0.15  likely prime
     For n  1000:   CV &lt; 0.12  likely prime
     For n &gt; 1000:   CV &lt; 0.30/(n/100)  likely prime
     Universal:      CV &gt; 0.27  likely composite
     Ambiguous zone: thresholds provide classification confidence
6. Return CV, gap_ratio, uniformity_score = 1/CV, verdict
            </pre>
        </div>

        <div class="section-title">9. Failure Modes and Limitations</div>

        <ul>
            <li><strong>Semiprime leakage:</strong> Composites with large prime factors can pass the test.</li>
            <li><strong>Carmichael-like pseudoprimes:</strong> These may evade simple gcd-based filtering.</li>
            <li><strong>Slice bias:</strong> Improper slice selection can undercount blocked channels.</li>
        </ul>

        <p>The heuristic is therefore best used as a rapid <em>prefilter</em> prior to a deterministic or probabilistic primality test (e.g., MillerRabin).</p>

        <div class="section-title">10. Conclusion</div>

        <p>Fractional-slice coprimality sampling provides a geometric and probabilistic bridge between Nested Farey Channel theory and practical number testing. It captures the essential property that prime moduli maintain maximal channel openness even when viewed through restricted arcs of the unit circle, while composites introduce blocked Farey channels visible through partial sampling.</p>

        <p>This heuristic can serve both as:</p>
        <ol>
            <li>A fast preliminary screen for prime candidates within modular sieves.</li>
            <li>A geometric diagnostic tool for visualizing the distribution of coprime residues across modular arcs.</li>
        </ol>

        <p>Further work includes: quantifying slice bias functions <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="84" style="font-size: 113.1%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FD TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi></mi><mi>S</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>, linking partial-channel openness to residue equidistribution, and integrating this fractional sampling into the modular sieve hierarchy for scalable prime detection.</p>

        <div style="margin-top: 50px; padding-top: 30px; border-top: 3px solid #667eea; text-align: center; color: #7f8c8d;">
            <p><em>Interactive paper by Wessen Getachew, October 2025</em></p>
            <p style="margin-top: 10px; font-size: 0.9em;">Full framework implementation with live algorithm demonstrations</p>
        </div>
    </div>

    <script>
        // ==================== UTILITY FUNCTIONS ====================
        
        function gcd(a, b) {
            while (b !== 0) {
                let temp = b;
                b = a % b;
                a = temp;
            }
            return a;
        }

        function eulerPhi(n) {
            let result = n;
            for (let p = 2; p * p <= n; p++) {
                if (n % p === 0) {
                    while (n % p === 0) n /= p;
                    result -= result / p;
                }
            }
            if (n > 1) result -= result / n;
            return Math.round(result);
        }

        function isPrime(n) {
            if (n < 2) return false;
            if (n === 2) return true;
            if (n % 2 === 0) return false;
            for (let i = 3; i * i <= n; i += 2) {
                if (n % i === 0) return false;
            }
            return true;
        }

        function smallestPrimeFactor(n) {
            if (n % 2 === 0) return 2;
            for (let i = 3; i * i <= n; i += 2) {
                if (n % i === 0) return i;
            }
            return n;
        }

        // ==================== CHANNEL VISUALIZATION ====================
        
        let showChannelLabels = false;

        function drawChannelRing() {
            const canvas = document.getElementById('channelCanvas');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = 280;

            const m = parseInt(document.getElementById('modInput').value);
            if (isNaN(m) || m < 2) return;

            ctx.clearRect(0, 0, width, height);

            // Draw circle
            ctx.strokeStyle = '#34495e';
            ctx.lineWidth = 2.5;
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
            ctx.stroke();

            // Draw origin
            ctx.fillStyle = '#e74c3c';
            ctx.beginPath();
            ctx.arc(centerX + radius, centerY, 10, 0, 2 * Math.PI);
            ctx.fill();

            // Draw channels
            const phi = eulerPhi(m);
            let openCount = 0, blockedCount = 0;

            for (let r = 1; r < m; r++) {
                const isOpen = gcd(r, m) === 1;
                const theta = (2 * Math.PI * r) / m;
                const x = centerX + radius * Math.cos(theta);
                const y = centerY - radius * Math.sin(theta);

                if (isOpen) openCount++;
                else blockedCount++;

                // Draw line
                ctx.strokeStyle = isOpen ? 'rgba(39, 174, 96, 0.3)' : 'rgba(231, 76, 60, 0.3)';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();

                // Draw point
                ctx.fillStyle = isOpen ? '#27ae60' : '#e74c3c';
                ctx.beginPath();
                ctx.arc(x, y, isOpen ? 6 : 5, 0, 2 * Math.PI);
                ctx.fill();

                if (showChannelLabels) {
                    ctx.fillStyle = '#2c3e50';
                    ctx.font = '11px serif';
                    const labelX = centerX + (radius + 30) * Math.cos(theta);
                    const labelY = centerY - (radius + 30) * Math.sin(theta);
                    ctx.fillText(`${r}`, labelX - 5, labelY + 4);
                }
            }

            // Display stats
            const statsDiv = document.getElementById('channelStats');
            statsDiv.innerHTML = `
                <div class="stat-row"><span class="stat-label">Modulus:</span><span class="stat-value">${m}</span></div>
                <div class="stat-row"><span class="stat-label">Open Channels:</span><span class="stat-value">${openCount}</span></div>
                <div class="stat-row"><span class="stat-label">Blocked Channels:</span><span class="stat-value">${blockedCount}</span></div>
                <div class="stat-row"><span class="stat-label">Density (m):</span><span class="stat-value">${(openCount/m).toFixed(4)}</span></div>
                <div class="stat-row"><span class="stat-label">Is Prime:</span><span class="stat-value">${isPrime(m) ? 'Yes ' : 'No'}</span></div>
            `;
            statsDiv.style.display = 'block';
        }

        function toggleChannelLabels() {
            showChannelLabels = !showChannelLabels;
            drawChannelRing();
        }

        // ==================== FRACTIONAL-SLICE TEST ====================
        
        function getSlice(m, sliceType) {
            if (sliceType === 'half') {
                return Array.from({length: Math.floor(m/2)}, (_, i) => i + 1);
            } else if (sliceType === 'quarter') {
                return Array.from({length: Math.floor(m/4)}, (_, i) => i + 1);
            } else {
                return Array.from({length: m-1}, (_, i) => i + 1);
            }
        }

        function runFractionalTest() {
            const m = parseInt(document.getElementById('testModulus').value);
            const k = parseInt(document.getElementById('sampleCount').value);
            const sliceType = document.getElementById('sliceType').value;

            if (isNaN(m) || m < 2 || isNaN(k) || k < 1) return;

            const canvas = document.getElementById('testCanvas');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = 220;

            ctx.clearRect(0, 0, width, height);

            // Draw circle
            ctx.strokeStyle = '#34495e';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
            ctx.stroke();

            // Get slice
            const slice = getSlice(m, sliceType);
            
            // Highlight slice region
            if (sliceType !== 'full') {
                ctx.fillStyle = 'rgba(102, 126, 234, 0.1)';
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                const maxTheta = (2 * Math.PI * slice[slice.length-1]) / m;
                ctx.arc(centerX, centerY, radius, -Math.PI/2, -Math.PI/2 + maxTheta);
                ctx.closePath();
                ctx.fill();
            }

            // Sample and test
            const samples = [];
            let allPass = true;

            for (let i = 0; i < k; i++) {
                const r = slice[Math.floor(Math.random() * slice.length)];
                const coprime = gcd(r, m) === 1;
                samples.push({r, coprime});
                if (!coprime) allPass = false;
            }

            // Draw all residues faintly
            for (let r = 1; r < m; r++) {
                const theta = (2 * Math.PI * r) / m;
                const x = centerX + radius * Math.cos(theta);
                const y = centerY - radius * Math.sin(theta);
                
                ctx.fillStyle = '#ddd';
                ctx.beginPath();
                ctx.arc(x, y, 3, 0, 2 * Math.PI);
                ctx.fill();
            }

            // Draw sampled residues
            samples.forEach(({r, coprime}) => {
                const theta = (2 * Math.PI * r) / m;
                const x = centerX + radius * Math.cos(theta);
                const y = centerY - radius * Math.sin(theta);

                // Draw ray
                ctx.strokeStyle = coprime ? 'rgba(39, 174, 96, 0.6)' : 'rgba(231, 76, 60, 0.6)';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();

                // Draw point
                ctx.fillStyle = coprime ? '#27ae60' : '#e74c3c';
                ctx.beginPath();
                ctx.arc(x, y, 8, 0, 2 * Math.PI);
                ctx.fill();

                // Label
                ctx.fillStyle = '#2c3e50';
                ctx.font = 'bold 12px serif';
                const labelX = centerX + (radius + 25) * Math.cos(theta);
                const labelY = centerY - (radius + 25) * Math.sin(theta);
                ctx.fillText(`${r}`, labelX - 8, labelY + 4);
            });

            // Display result
            const resultDiv = document.getElementById('testResult');
            const prime = isPrime(m);
            const q = smallestPrimeFactor(m);
            const theoreticalProb = Math.pow(1 - 1/q, k).toFixed(4);

            resultDiv.innerHTML = `
                <div class="test-result ${allPass ? 'pass' : 'fail'}">
                    <strong>Result:</strong> ${allPass ? 'PASS ' : 'FAIL '} - ${m} ${allPass ? 'is a prime candidate' : 'is composite (detected)'}
                </div>
                <div class="stats-display" style="margin-top: 15px;">
                    <div class="stat-row"><span class="stat-label">Modulus:</span><span class="stat-value">${m}</span></div>
                    <div class="stat-row"><span class="stat-label">Actual Status:</span><span class="stat-value">${prime ? 'Prime' : 'Composite'}</span></div>
                    <div class="stat-row"><span class="stat-label">Samples Tested:</span><span class="stat-value">${k}</span></div>
                    <div class="stat-row"><span class="stat-label">Passed Samples:</span><span class="stat-value">${samples.filter(s => s.coprime).length}/${k}</span></div>
                    <div class="stat-row"><span class="stat-label">Smallest Factor:</span><span class="stat-value">${q}</span></div>
                    <div class="stat-row"><span class="stat-label">Theoretical Pass Prob:</span><span class="stat-value">${theoreticalProb}</span></div>
                </div>
            `;
        }

        function runBatchTest() {
            const m = parseInt(document.getElementById('testModulus').value);
            const k = parseInt(document.getElementById('sampleCount').value);
            const sliceType = document.getElementById('sliceType').value;

            if (isNaN(m) || m < 2 || isNaN(k) || k < 1) return;

            const slice = getSlice(m, sliceType);
            let passCount = 0;

            for (let trial = 0; trial < 10; trial++) {
                let allPass = true;
                for (let i = 0; i < k; i++) {
                    const r = slice[Math.floor(Math.random() * slice.length)];
                    if (gcd(r, m) !== 1) {
                        allPass = false;
                        break;
                    }
                }
                if (allPass) passCount++;
            }

            const resultDiv = document.getElementById('batchResults');
            const prime = isPrime(m);
            const q = smallestPrimeFactor(m);
            const theoreticalProb = Math.pow(1 - 1/q, k);

            resultDiv.innerHTML = `
                <div class="stats-display" style="margin-top: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Batch Test Results (10 runs)</h4>
                    <div class="stat-row"><span class="stat-label">Modulus:</span><span class="stat-value">${m} (${prime ? 'Prime' : 'Composite'})</span></div>
                    <div class="stat-row"><span class="stat-label">Passes:</span><span class="stat-value">${passCount}/10</span></div>
                    <div class="stat-row"><span class="stat-label">Empirical Pass Rate:</span><span class="stat-value">${(passCount/10).toFixed(2)}</span></div>
                    <div class="stat-row"><span class="stat-label">Theoretical Pass Prob:</span><span class="stat-value">${theoreticalProb.toFixed(4)}</span></div>
                    <div class="stat-row"><span class="stat-label">Error:</span><span class="stat-value">${Math.abs(passCount/10 - theoreticalProb).toFixed(4)}</span></div>
                </div>
            `;
        }

        // ==================== LARGE-SCALE EXPERIMENT ====================
        
        function runExperiment() {
            const start = parseInt(document.getElementById('rangeStart').value);
            const end = parseInt(document.getElementById('rangeEnd').value);
            const k = parseInt(document.getElementById('expSamples').value);

            if (isNaN(start) || isNaN(end) || isNaN(k) || start >= end) return;

            const progressBar = document.getElementById('progressBar');
            const progressFill = document.getElementById('progressFill');
            progressBar.style.display = 'block';

            let truePositives = 0, falsePositives = 0;
            let trueNegatives = 0, falseNegatives = 0;

            const total = end - start + 1;
            let processed = 0;

            setTimeout(() => processRange(), 10);

            function processRange() {
                const batchSize = 10;
                const batchEnd = Math.min(processed + batchSize, total);

                for (let i = processed; i < batchEnd; i++) {
                    const m = start + i;
                    const prime = isPrime(m);
                    const passed = fractionalSliceTest(m, k, 'half');

                    if (prime && passed) truePositives++;
                    else if (!prime && passed) falsePositives++;
                    else if (!prime && !passed) trueNegatives++;
                    else if (prime && !passed) falseNegatives++;
                }

                processed = batchEnd;
                const progress = Math.round((processed / total) * 100);
                progressFill.style.width = progress + '%';
                progressFill.textContent = progress + '%';

                if (processed < total) {
                    setTimeout(processRange, 10);
                } else {
                    displayExperimentResults();
                }
            }

            function displayExperimentResults() {
                progressBar.style.display = 'none';

                const sensitivity = truePositives / (truePositives + falseNegatives);
                const specificity = trueNegatives / (trueNegatives + falsePositives);
                const precision = truePositives / (truePositives + falsePositives);

                const resultsDiv = document.getElementById('experimentResults');
                resultsDiv.innerHTML = `
                    <h4 style="color: #667eea; margin: 20px 0;">Experiment Results: Range [${start}, ${end}], k=${k}</h4>
                    <table>
                        <tr>
                            <th></th>
                            <th>Predicted Prime</th>
                            <th>Predicted Composite</th>
                        </tr>
                        <tr>
                            <td><strong>Actual Prime</strong></td>
                            <td style="background: #d4edda;">${truePositives}</td>
                            <td style="background: #f8d7da;">${falseNegatives}</td>
                        </tr>
                        <tr>
                            <td><strong>Actual Composite</strong></td>
                            <td style="background: #f8d7da;">${falsePositives}</td>
                            <td style="background: #d4edda;">${trueNegatives}</td>
                        </tr>
                    </table>
                    <div class="stats-display" style="margin-top: 20px;">
                        <div class="stat-row"><span class="stat-label">Sensitivity (TPR):</span><span class="stat-value">${(sensitivity * 100).toFixed(2)}%</span></div>
                        <div class="stat-row"><span class="stat-label">Specificity (TNR):</span><span class="stat-value">${(specificity * 100).toFixed(2)}%</span></div>
                        <div class="stat-row"><span class="stat-label">Precision (PPV):</span><span class="stat-value">${(precision * 100).toFixed(2)}%</span></div>
                        <div class="stat-row"><span class="stat-label">False Positive Rate:</span><span class="stat-value">${((1-specificity) * 100).toFixed(2)}%</span></div>
                    </div>
                `;
            }
        }

        function fractionalSliceTest(m, k, sliceType) {
            const slice = getSlice(m, sliceType);
            for (let i = 0; i < k; i++) {
                const r = slice[Math.floor(Math.random() * slice.length)];
                if (gcd(r, m) !== 1) return false;
            }
            return true;
        }

        // ==================== COMPREHENSIVE LEGEND EXPORT ====================
        
        function exportConcentricWithLegend(quality = '4k') {
            const canvas = document.getElementById('concentricCanvas');
            const originalWidth = canvas.width;
            const originalHeight = canvas.height;
            
            // Set resolution
            let exportWidth, exportHeight;
            if (quality === '4k') {
                exportWidth = exportHeight = 3840;
            } else if (quality === '2k') {
                exportWidth = exportHeight = 2560;
            } else {
                exportWidth = exportHeight = 1920;
            }
            
            // Temporarily resize and redraw
            canvas.width = exportWidth;
            canvas.height = exportHeight;
            drawConcentricRings();
            
            // Now create a new canvas with space for detailed legend
            const legendWidth = Math.floor(exportWidth * 0.3); // 30% width for legend
            const fullCanvas = document.createElement('canvas');
            fullCanvas.width = exportWidth + legendWidth;
            fullCanvas.height = exportHeight;
            const fullCtx = fullCanvas.getContext('2d');
            
            // White background
            fullCtx.fillStyle = 'white';
            fullCtx.fillRect(0, 0, fullCanvas.width, fullCanvas.height);
            
            // Draw main visualization
            fullCtx.drawImage(canvas, 0, 0);
            
            // Draw comprehensive legend
            drawComprehensiveLegend(fullCtx, exportWidth, 0, legendWidth, exportHeight);
            
            // Export
            const link = document.createElement('a');
            link.download = `concentric-${quality}-legend-${Date.now()}.png`;
            link.href = fullCanvas.toDataURL('image/png');
            link.click();
            
            // Restore original size
            canvas.width = originalWidth;
            canvas.height = originalHeight;
            drawConcentricRings();
        }

        function drawComprehensiveLegend(ctx, x, y, width, height) {
            const minMod = parseInt(document.getElementById('minMod').value);
            const maxMod = parseInt(document.getElementById('maxMod').value);
            const mode = document.getElementById('ringMode').value;
            const colorMode = document.getElementById('colorMode').value;
            const pointSize = parseFloat(document.getElementById('pointSize').value);
            const residueK = parseInt(document.getElementById('residueK')?.value || 3);
            
            // Calculate statistics
            let totalPoints = 0;
            let openPoints = 0;
            let blockedPoints = 0;
            let primeRings = 0;
            let compositeRings = 0;
            const gcdCounts = {};
            const primeFactorCounts = {};
            
            // Parse multi values for statistics
            let multiRValues = [];
            let multiMValues = [];
            if (mode === 'multi-r') {
                const inputStr = document.getElementById('multiRValues')?.value || '';
                multiRValues = parseMultiValues(inputStr);
            }
            if (mode === 'multi-m') {
                const inputStr = document.getElementById('multiMValues')?.value || '';
                multiMValues = parseMultiValues(inputStr);
            }
            
            for (let m = minMod; m <= maxMod; m++) {
                if (mode === 'primes-only' && !isPrime(m)) continue;
                if (mode === 'fixed-m') {
                    const fixedM = parseInt(document.getElementById('fixedMValue').value);
                    if (m !== fixedM) continue;
                }
                if (mode === 'multi-m' && !multiMValues.includes(m)) continue;
                
                if (isPrime(m)) primeRings++;
                else compositeRings++;
                
                for (let r = 1; r < m; r++) {
                    if (mode === 'fixed-r') {
                        const fixedR = parseInt(document.getElementById('fixedRValue').value);
                        if (r !== fixedR) continue;
                    }
                    if (mode === 'multi-r' && !multiRValues.includes(r)) continue;
                    
                    const gcdVal = gcd(r, m);
                    const isOpen = gcdVal === 1;
                    
                    totalPoints++;
                    if (isOpen) openPoints++;
                    else blockedPoints++;
                    
                    gcdCounts[gcdVal] = (gcdCounts[gcdVal] || 0) + 1;
                    
                    if (gcdVal > 1) {
                        const spf = smallestPrimeFactor(gcdVal);
                        primeFactorCounts[spf] = (primeFactorCounts[spf] || 0) + 1;
                    }
                }
            }
            
            // Drawing settings
            const padding = 20;
            const fontSize = Math.max(12, width / 40);
            const lineHeight = fontSize * 1.5;
            let currentY = y + padding;
            
            // Title
            ctx.fillStyle = '#2c3e50';
            ctx.font = `bold ${fontSize * 1.4}px Arial`;
            ctx.fillText('VISUALIZATION LEGEND', x + padding, currentY);
            currentY += lineHeight * 2;
            
            // Parameters Section
            ctx.font = `bold ${fontSize * 1.1}px Arial`;
            ctx.fillText(' PARAMETERS ', x + padding, currentY);
            currentY += lineHeight * 1.2;
            
            ctx.font = `${fontSize}px Arial`;
            const params = [
                `Modulus Range: ${minMod}  ${maxMod}`,
                `Display Mode: ${mode}`,
                `Color Mode: ${colorMode}`,
                `Point Size: ${pointSize}px`,
                mode === 'residue-class' ? `Residue mod k: ${residueK}` : null,
                mode === 'fixed-r' ? `Fixed r: ${document.getElementById('fixedRValue').value}` : null,
                mode === 'fixed-m' ? `Fixed m: ${document.getElementById('fixedMValue').value}` : null,
                mode === 'multi-r' ? `Multiple r: ${document.getElementById('multiRValues').value}` : null,
                mode === 'multi-m' ? `Multiple m: ${document.getElementById('multiMValues').value}` : null,
            ].filter(p => p !== null);
            
            params.forEach(param => {
                ctx.fillText(param, x + padding, currentY);
                currentY += lineHeight;
            });
            
            currentY += lineHeight * 0.5;
            
            // Statistics Section
            ctx.font = `bold ${fontSize * 1.1}px Arial`;
            ctx.fillText(' STATISTICS ', x + padding, currentY);
            currentY += lineHeight * 1.2;
            
            ctx.font = `${fontSize}px Arial`;
            const stats = [
                `Total Rings: ${primeRings + compositeRings}`,
                `Prime Rings: ${primeRings}`,
                `Composite Rings: ${compositeRings}`,
                `Total Points: ${totalPoints}`,
                `Open Channels: ${openPoints}`,
                `Blocked Channels: ${blockedPoints}`,
                `Open Density: ${(openPoints/totalPoints*100).toFixed(1)}%`,
            ];
            
            stats.forEach(stat => {
                ctx.fillText(stat, x + padding, currentY);
                currentY += lineHeight;
            });
            
            currentY += lineHeight * 0.5;
            
            // GCD Distribution
            if (Object.keys(gcdCounts).length > 0) {
                ctx.font = `bold ${fontSize * 1.1}px Arial`;
                ctx.fillText(' GCD DISTRIBUTION (ALL VALUES) ', x + padding, currentY);
                currentY += lineHeight * 1.2;
                
                ctx.font = `${fontSize * 0.85}px Arial`;
                const sortedGCDs = Object.keys(gcdCounts).map(Number).sort((a,b) => a-b);
                
                // Calculate how many can fit
                const maxGCDsToShow = Math.min(sortedGCDs.length, Math.floor((height - currentY) / (lineHeight * 0.85)) - 10);
                const gcdsToShow = sortedGCDs.slice(0, maxGCDsToShow);
                
                gcdsToShow.forEach(gcdVal => {
                    const count = gcdCounts[gcdVal];
                    const percentage = (count/totalPoints*100).toFixed(1);
                    
                    // Draw color sample with enhanced brightness
                    let sampleColor;
                    switch(colorMode) {
                        case 'gcd-local':
                        case 'gcd-gradient':
                            sampleColor = getGCDColor(gcdVal, Math.max(...Object.keys(gcdCounts).map(Number)));
                            break;
                        case 'gcd-global':
                            sampleColor = getGCDColorGlobal(gcdVal);
                            break;
                        case 'prime-factor':
                            sampleColor = getSmallestPrimeFactorColor(gcdVal);
                            break;
                        default:
                            sampleColor = gcdVal === 1 ? '#27ae60' : '#e74c3c';
                    }
                    
                    ctx.fillStyle = sampleColor;
                    ctx.beginPath();
                    ctx.arc(x + padding + 8, currentY - 3, 5, 0, 2 * Math.PI);
                    ctx.fill();
                    
                    ctx.fillStyle = '#2c3e50';
                    ctx.fillText(`gcd=${gcdVal}: ${count} (${percentage}%)`, x + padding + 20, currentY);
                    currentY += lineHeight * 0.85;
                });
                
                if (sortedGCDs.length > maxGCDsToShow) {
                    ctx.fillStyle = '#666';
                    ctx.fillText(`... and ${sortedGCDs.length - maxGCDsToShow} more GCD values`, x + padding, currentY);
                    currentY += lineHeight;
                }
            }
            
            currentY += lineHeight * 0.5;
            
            // Prime Factor Distribution (if applicable)
            if (Object.keys(primeFactorCounts).length > 0 && colorMode === 'prime-factor') {
                ctx.font = `bold ${fontSize * 1.1}px Arial`;
                ctx.fillText(' PRIME FACTORS ', x + padding, currentY);
                currentY += lineHeight * 1.2;
                
                ctx.font = `${fontSize * 0.9}px Arial`;
                const sortedPrimes = Object.keys(primeFactorCounts).map(Number).sort((a,b) => a-b);
                sortedPrimes.forEach(prime => {
                    const count = primeFactorCounts[prime];
                    const color = getSmallestPrimeFactorColor(prime);
                    
                    ctx.fillStyle = color;
                    ctx.beginPath();
                    ctx.arc(x + padding + 8, currentY - 4, 6, 0, 2 * Math.PI);
                    ctx.fill();
                    
                    ctx.fillStyle = '#2c3e50';
                    ctx.fillText(`Prime ${prime}: ${count} points`, x + padding + 20, currentY);
                    currentY += lineHeight * 0.9;
                });
            }
            
            currentY += lineHeight * 0.5;
            
            // Color Mode Explanation
            ctx.font = `bold ${fontSize * 1.1}px Arial`;
            ctx.fillText(' COLOR KEY ', x + padding, currentY);
            currentY += lineHeight * 1.2;
            
            ctx.font = `${fontSize * 0.85}px Arial`;
            const colorExplanations = {
                'open-blocked': ['Green = Coprime (open)', 'Red = Blocked'],
                'gcd-gradient': ['GreenRed gradient', 'by GCD magnitude'],
                'gcd-local': ['Colors per ring', 'by GCD value'],
                'gcd-global': ['Same GCD =', 'same color globally'],
                'prime-factor': ['Color = smallest', 'prime factor of gcd'],
                'density-local': ['Brightness = local', 'coprime density'],
                'residue-class': [`Colors by r mod ${residueK}`],
                'farey-level': ['Brightness = reduced', 'denominator level'],
                'angular-hue': ['Hue by angle', 'Brightness by coprime'],
                'multi-property': ['Hue=angle, Sat=gcd', 'Bright=slice member'],
            };
            
            const explanations = colorExplanations[colorMode] || ['Standard coloring'];
            explanations.forEach(line => {
                ctx.fillText(line, x + padding, currentY);
                currentY += lineHeight * 0.85;
            });
            
            // Footer
            currentY = y + height - padding - lineHeight * 2;
            ctx.font = `${fontSize * 0.8}px Arial`;
            ctx.fillStyle = '#95a5a6';
            ctx.fillText('Generated: ' + new Date().toLocaleString(), x + padding, currentY);
            currentY += lineHeight;
            ctx.fillText('Nested Farey Channels Framework', x + padding, currentY);
            ctx.fillText('by Wessen Getachew', x + padding, currentY + lineHeight);
        }

        // ==================== CHORD LENGTH ANALYSIS ====================
        
        function computeChordLengths(n) {
            const R_n = [];
            for (let r = 1; r < n; r++) {
                if (gcd(r, n) === 1) R_n.push(r);
            }
            
            if (R_n.length === 0) return [];
            
            const chords = [];
            
            // Consecutive chords
            for (let i = 0; i < R_n.length - 1; i++) {
                const r_i = R_n[i];
                const r_next = R_n[i + 1];
                const angleDiff = (r_next - r_i) / n;
                const chord = 2 * Math.sin(Math.PI * angleDiff);
                chords.push(chord);
            }
            
            // Wrap-around chord
            const r_last = R_n[R_n.length - 1];
            const r_first = R_n[0];
            const angleDiff = (r_first + n - r_last) / n;
            const chord = 2 * Math.sin(Math.PI * angleDiff);
            chords.push(chord);
            
            return chords;
        }

        function computeChordStatistics(chords) {
            if (chords.length === 0) return null;
            
            const min = Math.min(...chords);
            const max = Math.max(...chords);
            const sum = chords.reduce((a, b) => a + b, 0);
            const mean = sum / chords.length;
            
            const variance = chords.reduce((acc, c) => acc + (c - mean) ** 2, 0) / chords.length;
            const stdDev = Math.sqrt(variance);
            
            const cv = stdDev / mean;
            const gapRatio = max / min;
            const uniformityScore = cv > 0 ? 1.0 / cv : Infinity;
            
            return {
                min, max, mean, stdDev, cv, gapRatio, uniformityScore,
                count: chords.length
            };
        }

        function analyzeChordLengths() {
            const n = parseInt(document.getElementById('chordModulus').value);
            if (isNaN(n) || n < 3) {
                alert('Please enter a valid modulus  3');
                return;
            }
            
            const chords = computeChordLengths(n);
            const stats = computeChordStatistics(chords);
            
            if (!stats) {
                document.getElementById('chordResults').innerHTML = 
                    '<p style="color: #e74c3c;">No coprime residues found!</p>';
                return;
            }
            
            const prime = isPrime(n);
            const phi_n = eulerPhi(n);
            
            // Adaptive threshold based on n
            let primeThreshold;
            if (n <= 100) primeThreshold = 0.22;
            else if (n <= 500) primeThreshold = 0.15;
            else if (n <= 1000) primeThreshold = 0.12;
            else primeThreshold = 0.30 / Math.sqrt(n / 100);
            
            const compositeThreshold = 0.27;
            
            // Determine verdict
            let verdict = '';
            let verdictColor = '';
            if (stats.cv < primeThreshold) {
                verdict = 'Likely PRIME (high uniformity)';
                verdictColor = '#27ae60';
            } else if (stats.cv > compositeThreshold) {
                verdict = 'Likely COMPOSITE (low uniformity)';
                verdictColor = '#e74c3c';
            } else {
                verdict = 'AMBIGUOUS (borderline uniformity)';
                verdictColor = '#f39c12';
            }
            
            const correct = (stats.cv < primeThreshold && prime) || (stats.cv > compositeThreshold && !prime);
            
            // Display results
            document.getElementById('chordResults').innerHTML = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid ${verdictColor};">
                    <h4 style="color: #2c3e50; margin-top: 0;">Results for n = ${n}</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <strong>Actual Type:</strong> ${prime ? 'PRIME' : 'COMPOSITE'} <br>
                            <strong>(n):</strong> ${phi_n}<br>
                            <strong>Chord Count:</strong> ${stats.count}<br>
                            <strong>Prime Threshold (n=${n}):</strong> ${primeThreshold.toFixed(3)}<br>
                        </div>
                        <div>
                            <strong>Min Chord:</strong> ${stats.min.toFixed(6)}<br>
                            <strong>Max Chord:</strong> ${stats.max.toFixed(6)}<br>
                            <strong>Mean Chord:</strong> ${stats.mean.toFixed(6)}<br>
                            <strong>Composite Threshold:</strong> ${compositeThreshold.toFixed(3)}<br>
                        </div>
                    </div>
                    <hr style="margin: 15px 0; border: none; border-top: 1px solid #dee2e6;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <strong>Std Deviation:</strong> ${stats.stdDev.toFixed(6)}<br>
                            <strong style="color: #667eea;">Coefficient of Variation:</strong> ${stats.cv.toFixed(6)}<br>
                            <strong>Gap Ratio (max/min):</strong> ${stats.gapRatio.toFixed(4)}<br>
                        </div>
                        <div>
                            <strong>Uniformity Score (1/CV):</strong> ${stats.uniformityScore.toFixed(2)}<br>
                            <strong style="color: ${verdictColor};">Heuristic Verdict:</strong><br>
                            <span style="color: ${verdictColor};">${verdict}</span><br>
                            <strong>Match:</strong> ${correct ? ' Correct!' : ' Mismatch'}
                        </div>
                    </div>
                    <div style="margin-top: 15px; padding: 10px; background: rgba(102, 126, 234, 0.1); border-radius: 4px;">
                        <small><em><strong>Note:</strong> Threshold adapts based on range. Larger n uses tighter threshold as prime CV  0.</em></small>
                    </div>
                </div>
            `;
            
            // Draw chord distribution chart
            drawChordDistribution(chords, stats, n, prime);
        }

        function drawChordDistribution(chords, stats, n, isPrime) {
            const canvas = document.getElementById('chordCanvas');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // Background
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, width, height);
            
            // Margins
            const margin = {top: 40, right: 40, bottom: 60, left: 80};
            const plotWidth = width - margin.left - margin.right;
            const plotHeight = height - margin.top - margin.bottom;
            
            // Histogram
            const binCount = Math.min(20, chords.length);
            const bins = new Array(binCount).fill(0);
            const binWidth = (stats.max - stats.min) / binCount;
            
            chords.forEach(chord => {
                const binIndex = Math.min(binCount - 1, Math.floor((chord - stats.min) / binWidth));
                bins[binIndex]++;
            });
            
            const maxBinHeight = Math.max(...bins);
            
            // Draw axes
            ctx.strokeStyle = '#2c3e50';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(margin.left, margin.top);
            ctx.lineTo(margin.left, height - margin.bottom);
            ctx.lineTo(width - margin.right, height - margin.bottom);
            ctx.stroke();
            
            // Draw histogram bars
            const barWidth = plotWidth / binCount;
            bins.forEach((count, i) => {
                if (count === 0) return;
                
                const barHeight = (count / maxBinHeight) * plotHeight;
                const x = margin.left + i * barWidth;
                const y = height - margin.bottom - barHeight;
                
                ctx.fillStyle = isPrime ? 'rgba(39, 174, 96, 0.7)' : 'rgba(231, 76, 60, 0.7)';
                ctx.fillRect(x, y, barWidth * 0.9, barHeight);
                
                ctx.strokeStyle = isPrime ? '#27ae60' : '#e74c3c';
                ctx.lineWidth = 1;
                ctx.strokeRect(x, y, barWidth * 0.9, barHeight);
            });
            
            // Draw mean line
            const meanX = margin.left + ((stats.mean - stats.min) / (stats.max - stats.min)) * plotWidth;
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(meanX, margin.top);
            ctx.lineTo(meanX, height - margin.bottom);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Labels
            ctx.fillStyle = '#2c3e50';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            
            // X-axis label
            ctx.fillText('Chord Length', width / 2, height - 20);
            
            // Y-axis label
            ctx.save();
            ctx.translate(20, height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('Frequency', 0, 0);
            ctx.restore();
            
            // Title
            ctx.font = 'bold 16px Arial';
            ctx.fillText(`Chord Length Distribution: n=${n} (${isPrime ? 'PRIME' : 'COMPOSITE'})`, 
                        width / 2, 25);
            
            // X-axis ticks
            ctx.font = '12px Arial';
            const tickCount = 5;
            for (let i = 0; i <= tickCount; i++) {
                const value = stats.min + (stats.max - stats.min) * i / tickCount;
                const x = margin.left + plotWidth * i / tickCount;
                ctx.fillText(value.toFixed(3), x, height - margin.bottom + 20);
            }
            
            // Y-axis ticks
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const value = Math.round(maxBinHeight * i / 5);
                const y = height - margin.bottom - plotHeight * i / 5;
                ctx.fillText(value.toString(), margin.left - 10, y + 4);
            }
            
            // Legend
            ctx.textAlign = 'left';
            ctx.font = '12px Arial';
            ctx.fillStyle = '#667eea';
            ctx.fillText(`Mean = ${stats.mean.toFixed(4)}`, width - margin.right - 150, margin.top + 10);
            ctx.fillStyle = '#2c3e50';
            ctx.fillText(`CV = ${stats.cv.toFixed(4)}`, width - margin.right - 150, margin.top + 30);
        }

        function compareChordDistributions() {
            const results = [];
            const testRange = [7, 9, 11, 15, 17, 21, 23, 25, 29, 30];
            
            for (const n of testRange) {
                const chords = computeChordLengths(n);
                const stats = computeChordStatistics(chords);
                if (stats) {
                    results.push({
                        n,
                        prime: isPrime(n),
                        cv: stats.cv,
                        gap: stats.gapRatio,
                        uniformity: stats.uniformityScore
                    });
                }
            }
            
            const primes = results.filter(r => r.prime);
            const composites = results.filter(r => !r.prime);
            
            const avgCVPrime = primes.reduce((sum, r) => sum + r.cv, 0) / primes.length;
            const avgCVComp = composites.reduce((sum, r) => sum + r.cv, 0) / composites.length;
            
            let html = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-top: 20px;">
                    <h4 style="color: #2c3e50;">Comparative Analysis: Primes vs Composites</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                        <div style="background: rgba(39, 174, 96, 0.1); padding: 15px; border-radius: 4px;">
                            <h5 style="color: #27ae60; margin-top: 0;">PRIMES</h5>
                            <strong>Average CV:</strong> ${avgCVPrime.toFixed(4)}<br>
                            <table style="width: 100%; margin-top: 10px; font-size: 0.9em;">
                                <tr style="border-bottom: 1px solid #dee2e6;"><th>n</th><th>CV</th><th>Gap Ratio</th></tr>
            `;
            
            primes.forEach(r => {
                html += `<tr><td>${r.n}</td><td>${r.cv.toFixed(4)}</td><td>${r.gap.toFixed(2)}</td></tr>`;
            });
            
            html += `
                            </table>
                        </div>
                        <div style="background: rgba(231, 76, 60, 0.1); padding: 15px; border-radius: 4px;">
                            <h5 style="color: #e74c3c; margin-top: 0;">COMPOSITES</h5>
                            <strong>Average CV:</strong> ${avgCVComp.toFixed(4)}<br>
                            <table style="width: 100%; margin-top: 10px; font-size: 0.9em;">
                                <tr style="border-bottom: 1px solid #dee2e6;"><th>n</th><th>CV</th><th>Gap Ratio</th></tr>
            `;
            
            composites.forEach(r => {
                html += `<tr><td>${r.n}</td><td>${r.cv.toFixed(4)}</td><td>${r.gap.toFixed(2)}</td></tr>`;
            });
            
            const separation = Math.abs(avgCVPrime - avgCVComp) / Math.max(avgCVPrime, avgCVComp) * 100;
            
            html += `
                            </table>
                        </div>
                    </div>
                    <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 4px; border-left: 4px solid #667eea;">
                        <strong>Statistical Separation:</strong> ${separation.toFixed(1)}%<br>
                        <strong>Conclusion:</strong> ${separation > 20 ? ' Significant distinction!' : ' Weak distinction'}<br>
                        <em>Primes exhibit ${avgCVPrime < avgCVComp ? 'lower' : 'higher'} coefficient of variation, 
                        indicating ${avgCVPrime < avgCVComp ? 'more' : 'less'} uniform chord spacing.</em>
                    </div>
                </div>
            `;
            
            document.getElementById('chordResults').innerHTML = html;
        }

        // Initialize
        drawChannelRing();
        updateColorModeInfo();

        // ==================== RESULTS HISTORY ====================
        
        let testHistory = [];

        function addToHistory(result) {
            testHistory.unshift(result);
            if (testHistory.length > 50) testHistory.pop();
            updateHistoryDisplay();
        }

        function updateHistoryDisplay() {
            const historyDiv = document.getElementById('testHistory');
            const listDiv = document.getElementById('testHistoryList');
            
            if (testHistory.length === 0) {
                historyDiv.style.display = 'none';
                return;
            }
            
            historyDiv.style.display = 'block';
            listDiv.innerHTML = testHistory.map((item, idx) => `
                <div class="result-item" onclick="toggleResultDetails(${idx})">
                    <div class="result-header">
                        <span class="result-title">${item.type}: m=${item.modulus}, k=${item.k}</span>
                        <span class="result-time">${item.timestamp}</span>
                    </div>
                    <div class="result-summary">
                        Result: ${item.passed ? 'PASS ' : 'FAIL '} | 
                        ${item.prime ? 'Prime' : 'Composite'} | 
                        Density: ${item.density}
                    </div>
                    <div class="collapsed-details">
                        <strong>Details:</strong><br>
                        Samples: ${item.passedSamples}/${item.k}<br>
                        Smallest Factor: ${item.smallestFactor}<br>
                        Theoretical Prob: ${item.theoreticalProb}<br>
                        Slice Type: ${item.sliceType}
                    </div>
                </div>
            `).join('');
        }

        function toggleResultDetails(idx) {
            const items = document.querySelectorAll('.result-item');
            items[idx].classList.toggle('expanded');
        }

        function clearTestHistory() {
            if (confirm('Clear all test history?')) {
                testHistory = [];
                updateHistoryDisplay();
            }
        }

        // ==================== EXPORT FUNCTIONS ====================
        
        function exportTestScreenshot() {
            const canvas = document.getElementById('testCanvas');
            const link = document.createElement('a');
            link.download = `farey-test-${Date.now()}.png`;
            link.href = canvas.toDataURL();
            link.click();
        }

        function exportConcentricView() {
            const canvas = document.getElementById('concentricCanvas');
            const link = document.createElement('a');
            link.download = `concentric-rings-${Date.now()}.png`;
            link.href = canvas.toDataURL();
            link.click();
        }

        function exportTestData(format) {
            if (testHistory.length === 0) {
                alert('No test history to export');
                return;
            }

            let content, mimeType, extension;

            if (format === 'json') {
                content = JSON.stringify(testHistory, null, 2);
                mimeType = 'application/json';
                extension = 'json';
            } else if (format === 'csv') {
                const headers = 'Timestamp,Type,Modulus,Prime,Passed,Samples(k),PassedSamples,Density,SmallestFactor,TheoreticalProb,SliceType\n';
                const rows = testHistory.map(item => 
                    `"${item.timestamp}",${item.type},${item.modulus},${item.prime},${item.passed},${item.k},${item.passedSamples},${item.density},${item.smallestFactor},${item.theoreticalProb},${item.sliceType}`
                ).join('\n');
                content = headers + rows;
                mimeType = 'text/csv';
                extension = 'csv';
            }

            const blob = new Blob([content], { type: mimeType });
            const link = document.createElement('a');
            link.download = `farey-tests-${Date.now()}.${extension}`;
            link.href = URL.createObjectURL(blob);
            link.click();
        }

        // ==================== CONCENTRIC RINGS VISUALIZATION ====================
        
        let concentricResolution = 2560;

        function setConcentricResolution(res) {
            concentricResolution = res;
            const canvas = document.getElementById('concentricCanvas');
            canvas.width = res;
            canvas.height = res;
            
            // Update button states
            document.querySelectorAll('.canvas-container .mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            drawConcentricRings();
        }

        // Update label font size display
        document.getElementById('labelFontSize')?.addEventListener('input', function() {
            document.getElementById('labelFontSizeVal').textContent = this.value;
        });
        
        // Toggle GCD=1 label controls visibility
        function updateGCD1LabelControls() {
            const showLabels = document.getElementById('showGCD1Labels').checked;
            const controlsDiv = document.getElementById('gcd1LabelControls');
            controlsDiv.style.display = showLabels ? 'block' : 'none';
        }

        // Update point size display
        document.getElementById('pointSize')?.addEventListener('input', function() {
            document.getElementById('pointSizeVal').textContent = this.value;
        });

        // Show/hide fixed value inputs based on mode
        function updateModeControls() {
            const mode = document.getElementById('ringMode').value;
            const fixedRGroup = document.getElementById('fixedRGroup');
            const fixedMGroup = document.getElementById('fixedMGroup');
            const multiRGroup = document.getElementById('multiRGroup');
            const multiMGroup = document.getElementById('multiMGroup');
            
            fixedRGroup.style.display = mode === 'fixed-r' ? 'flex' : 'none';
            fixedMGroup.style.display = mode === 'fixed-m' ? 'flex' : 'none';
            multiRGroup.style.display = mode === 'multi-r' ? 'flex' : 'none';
            multiMGroup.style.display = mode === 'multi-m' ? 'flex' : 'none';
        }
        
        document.getElementById('ringMode')?.addEventListener('change', updateModeControls);
        
        // Helper functions for multi-select presets
        function setMultiR(preset) {
            let values = [];
            if (preset === 'primes') {
                values = [2,3,5,7,11,13,17,19];
            } else if (preset === 'composites') {
                values = [4,6,8,9,10,12,14,15,16,18,20];
            } else if (preset === 'powers2') {
                values = [1,2,4,8,16,32,64];
            } else if (preset === 'powers3') {
                values = [1,3,9,27,81];
            }
            document.getElementById('multiRValues').value = values.join(',');
        }
        
        function setMultiM(preset) {
            let values = [];
            if (preset === 'primes') {
                values = [2,3,5,7,11,13,17,19,23,29];
            } else if (preset === 'composites') {
                values = [4,6,8,9,10,12,14,15,16,18,20,21,22,24,25,26,27,28,30];
            } else if (preset === 'fibonacci') {
                values = [1,2,3,5,8,13,21,34,55,89];
            } else if (preset === 'highly-composite') {
                values = [1,2,4,6,12,24,36,48,60,120];
            }
            document.getElementById('multiMValues').value = values.join(',');
        }
        
        function parseMultiValues(inputStr) {
            return inputStr.split(',').map(s => parseInt(s.trim())).filter(n => !isNaN(n) && n > 0);
        }

        // GCD-based color palette
        const gcdColors = [
            '#e74c3c', // gcd=1 (or blocked)
            '#27ae60', // gcd=1 (coprime)
            '#3498db', // gcd=2
            '#f39c12', // gcd=3
            '#9b59b6', // gcd=4
            '#1abc9c', // gcd=5
            '#e67e22', // gcd=6
            '#34495e', // gcd=7
            '#16a085', // gcd=8
            '#d35400', // gcd=9
            '#c0392b', // gcd=10+
        ];

        function getGCDColor(gcdValue, maxGCD) {
            if (gcdValue === 1) return '#27ae60'; // Coprime - always green
            
            // Map gcd to color index
            const idx = Math.min(gcdValue, gcdColors.length - 1);
            return gcdColors[idx];
        }

        function getGCDColorGlobal(gcdValue) {
            // Enhanced with brighter, more vibrant colors
            const globalColors = {
                1: '#2ecc71',  // Bright green - Coprime
                2: '#e74c3c',  // Red - Even
                3: '#3498db',  // Blue - Multiple of 3
                4: '#f39c12',  // Orange - Multiple of 4
                5: '#9b59b6',  // Purple - Multiple of 5
                6: '#1abc9c',  // Turquoise - Multiple of 6
                7: '#e67e22',  // Dark orange - Multiple of 7
                8: '#34495e',  // Dark blue-gray - Multiple of 8
                9: '#16a085',  // Teal - Multiple of 9
                10: '#d35400', // Dark red - Multiple of 10
                11: '#27ae60', // Green - Multiple of 11
                12: '#c0392b', // Crimson - Multiple of 12
                13: '#8e44ad', // Dark purple - Multiple of 13
                14: '#f1c40f', // Yellow - Multiple of 14
                15: '#2980b9', // Medium blue - Multiple of 15
                16: '#7f8c8d', // Gray - Multiple of 16
                17: '#16a085', // Cyan - Multiple of 17
                18: '#d35400', // Burnt orange - Multiple of 18
                19: '#8e44ad', // Violet - Multiple of 19
                20: '#c0392b', // Brick red - Multiple of 20
            };
            
            // For higher GCD values, generate based on prime factorization
            if (gcdValue > 20) {
                const spf = smallestPrimeFactor(gcdValue);
                const hue = (spf * 37) % 360; // Spread hues based on prime
                const sat = 65 + (gcdValue % 3) * 10; // Vary saturation
                const light = 40 + (gcdValue % 4) * 10; // Vary brightness
                return `hsl(${hue}, ${sat}%, ${light}%)`;
            }
            
            return globalColors[gcdValue] || '#95a5a6';
        }

        // Enhanced GCD Gradient with better scaling
        function getGCDGradientColor(gcdValue, maxGCD) {
            if (gcdValue === 1) return '#2ecc71'; // Bright coprime green
            
            // Enhanced gradient with better brightness scaling
            const intensity = gcdValue / maxGCD;
            const hue = 120 * (1 - intensity); // 120=green to 0=red
            const sat = 75 + intensity * 15; // Increase saturation for higher GCD
            const light = 55 - intensity * 15; // Decrease lightness for visibility
            return `hsl(${hue}, ${sat}%, ${light}%)`;
        }

        // Enhanced smallest prime factor with cobalt scaling
        function getSmallestPrimeFactorColor(gcdValue) {
            if (gcdValue === 1) return '#ecf0f1'; // Near-white for coprime
            
            const spf = smallestPrimeFactor(gcdValue);
            
            // Enhanced with brighter, more distinct colors
            const primeColors = {
                2: '#4A90E2',   // Bright cobalt blue
                3: '#F5A623',   // Golden yellow
                5: '#FF6B6B',   // Coral red
                7: '#A05EB5',   // Lavender purple
                11: '#50E3C2',  // Bright turquoise
                13: '#E85D75',  // Rose red
                17: '#4ECDC4',  // Teal cyan
                19: '#FF8C42',  // Bright orange
                23: '#9B59B6',  // Purple
                29: '#2ECC71',  // Emerald green
                31: '#3D5A80',  // Steel blue
                37: '#16DB93',  // Mint green
                41: '#FAC05E',  // Mellow yellow
                43: '#EE6C4D',  // Burnt sienna
                47: '#8B5CF6',  // Violet
            };
            return primeColors[spf] || '#95a5a6';
        }

        // Enhanced local density with brighter gradient
        function getLocalDensityColor(r, m, windowSize = 5) {
            // Count coprime residues in window around r
            let coprimeCount = 0;
            const halfWindow = Math.floor(windowSize / 2);
            
            for (let i = -halfWindow; i <= halfWindow; i++) {
                const testR = ((r + i - 1 + m) % m) + 1;
                if (testR >= 1 && testR < m && gcd(testR, m) === 1) {
                    coprimeCount++;
                }
            }
            
            const density = coprimeCount / windowSize;
            const hue = 200 + density * 60; // Cobalt to cyan range
            const sat = 70 + density * 20; // Increase saturation with density
            const light = 35 + density * 35; // Brighter with more density
            return `hsl(${hue}, ${sat}%, ${light}%)`;
        }

        // Enhanced residue class coloring
        function getResidueClassColor(r, k) {
            const residue = r % k;
            const hue = (residue * 360) / k;
            const sat = 75; // Higher saturation
            const light = 50 + (residue % 2) * 10; // Slight brightness variation
            return `hsl(${hue}, ${sat}%, ${light}%)`;
        }

        // Enhanced Farey level with cobalt emphasis
        function getFareyLevelColor(r, m) {
            const g = gcd(r, m);
            const reducedDenom = m / g;
            
            // Cobalt blue gradient - smaller denominators = brighter cobalt
            const maxDenom = m;
            const ratio = reducedDenom / maxDenom;
            const hue = 210; // Cobalt blue hue
            const sat = 70 + (1 - ratio) * 25; // More saturated for smaller denominators
            const light = 65 - ratio * 35; // Brighter for smaller denominators
            return `hsl(${hue}, ${sat}%, ${light}%)`;
        }

        // NEW: Angular hue coloring
        function getAngularHueColor(r, m) {
            const angle = (2 * Math.PI * r) / m;
            const hue = (angle / (2 * Math.PI)) * 360;
            const isOpen = gcd(r, m) === 1;
            const sat = 70;
            const light = isOpen ? 50 : 30; // Brighter if coprime
            return `hsl(${hue}, ${sat}%, ${light}%)`;
        }

        // NEW: Multi-property (HSB) coloring
        function getMultiPropertyColor(r, m, inSlice = true) {
            const g = gcd(r, m);
            const angle = (2 * Math.PI * r) / m;
            
            // Hue: angle
            const hue = (angle / (2 * Math.PI)) * 360;
            
            // Saturation: gcd (coprime = high saturation)
            const sat = g === 1 ? 80 : 30;
            
            // Brightness: slice membership
            const light = inSlice ? 60 : 30;
            
            return `hsl(${hue}, ${sat}%, ${light}%)`;
        }

        // Color mode info text
        function updateColorModeInfo() {
            const mode = document.getElementById('colorMode').value;
            const infoDiv = document.getElementById('colorModeInfo');
            const residueGroup = document.getElementById('residueClassGroup');
            
            const infoTexts = {
                'open-blocked': 'Binary: Green=coprime, Red=blocked',
                'gcd-gradient': 'Gradient intensity by gcd(r,m) magnitude',
                'gcd-local': 'Each ring: independent color per GCD value',
                'gcd-global': 'All rings: same GCD = same color (shows nesting)',
                'prime-factor': 'Color by smallest prime factor of gcd(r,m)',
                'density-local': 'Heatmap: local coprime density around each r',
                'residue-class': 'Color by residue class r mod k',
                'farey-level': 'Brightness by reduced denominator (Farey level)',
                'angular-hue': 'Hue by angle, brightness by coprimality',
                'multi-property': 'Hue=angle, Saturation=gcd, Brightness=slice'
            };
            
            infoDiv.textContent = infoTexts[mode] || '';
            residueGroup.style.display = mode === 'residue-class' ? 'flex' : 'none';
        }

        function drawConcentricRings() {
            const canvas = document.getElementById('concentricCanvas');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            const centerX = width / 2;
            const centerY = height / 2;

            const minMod = parseInt(document.getElementById('minMod').value);
            const maxMod = parseInt(document.getElementById('maxMod').value);
            const mode = document.getElementById('ringMode').value;
            const colorMode = document.getElementById('colorMode').value;
            const pointSize = parseFloat(document.getElementById('pointSize').value);
            
            const showRings = document.getElementById('showRings').checked;
            const showLabels = document.getElementById('showLabels').checked;
            const showAxes = document.getElementById('showAxes').checked;
            const showLegend = document.getElementById('showLegend').checked;
            
            // NEW FEATURES
            const invertRings = document.getElementById('invertRings')?.checked || false;
            const darkBg = document.getElementById('concentricDarkBg')?.checked || false;
            const globalRot = parseFloat(document.getElementById('globalRotation')?.value || 0) * Math.PI / 180;
            const localRot = parseFloat(document.getElementById('localRotation')?.value || 0) * Math.PI / 180;
            const individualRot = parseFloat(document.getElementById('individualRotation')?.value || 0) * Math.PI / 180;
            const trackR = parseInt(document.getElementById('trackResidue')?.value || 1);
            const showAllR = document.getElementById('showAllR')?.checked !== false;
            const highlightTracked = document.getElementById('highlightTracked')?.checked !== false;

            // Parse multi-values for multi-r and multi-m modes
            let multiRValues = [];
            let multiMValues = [];
            if (mode === 'multi-r') {
                const inputStr = document.getElementById('multiRValues')?.value || '';
                multiRValues = parseMultiValues(inputStr);
            }
            if (mode === 'multi-m') {
                const inputStr = document.getElementById('multiMValues')?.value || '';
                multiMValues = parseMultiValues(inputStr);
            }

            if (isNaN(minMod) || isNaN(maxMod) || minMod > maxMod) return;

            // Background
            ctx.fillStyle = darkBg ? '#000000' : '#ffffff';
            ctx.fillRect(0, 0, width, height);
            
            const textColor = darkBg ? '#ffffff' : '#2c3e50';
            const gridColor = darkBg ? '#444444' : '#e0e0e0';

            // Draw axes
            if (showAxes) {
                ctx.strokeStyle = gridColor;
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(0, centerY);
                ctx.lineTo(width, centerY);
                ctx.moveTo(centerX, 0);
                ctx.lineTo(centerX, height);
                ctx.stroke();
            }

            const maxRadius = Math.min(width, height) / 2 - 80;
            const radiusStep = maxRadius / (maxMod - minMod + 1);

            // For fixed-m mode
            let fixedM = null;
            if (mode === 'fixed-m') {
                fixedM = parseInt(document.getElementById('fixedMValue').value);
            }

            // For fixed-r mode
            let fixedR = null;
            if (mode === 'fixed-r') {
                fixedR = parseInt(document.getElementById('fixedRValue').value);
            }

            // Collect all GCD values for legend
            let allGCDs = new Set();
            for (let m = minMod; m <= maxMod; m++) {
                if (m === 1) {
                    allGCDs.add(1);
                    continue;
                }
                if (mode === 'primes-only' && !isPrime(m)) continue;
                if (mode === 'fixed-m' && m !== fixedM) continue;
                if (mode === 'multi-m' && !multiMValues.includes(m)) continue;
                
                for (let r = 1; r < m; r++) {
                    if (mode === 'fixed-r' && r !== fixedR) continue;
                    if (mode === 'multi-r' && !multiRValues.includes(r)) continue;
                    allGCDs.add(gcd(r, m));
                }
            }

            // Draw concentric rings
            for (let m = minMod; m <= maxMod; m++) {
                if (mode === 'primes-only' && !isPrime(m)) continue;
                if (mode === 'fixed-m' && m !== fixedM) continue;
                if (mode === 'multi-m' && !multiMValues.includes(m)) continue;

                // Calculate radius - invert if needed
                let radius;
                if (invertRings) {
                    radius = radiusStep * (maxMod - m + 1);
                } else {
                    radius = radiusStep * (m - minMod + 1);
                }
                
                const prime = isPrime(m);

                // Draw ring circle
                if (showRings) {
                    ctx.strokeStyle = prime ? '#27ae60' : (darkBg ? '#888888' : '#95a5a6');
                    ctx.lineWidth = prime ? 3 : 1.5;
                    ctx.setLineDash(prime ? [] : [10, 5]);
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
                    ctx.stroke();
                    ctx.setLineDash([]);
                }

                // Draw label
                if (showLabels) {
                    ctx.fillStyle = prime ? '#27ae60' : textColor;
                    ctx.font = `bold ${Math.max(10, Math.min(14, width/180))}px Arial`;
                    let label = '';
                    if (mode === 'fixed-r') {
                        label = `m=${m}, r=${fixedR}`;
                    } else if (mode === 'fixed-m') {
                        label = `m=${fixedM}`;
                    } else if (mode === 'multi-r') {
                        label = `m=${m}, r{${multiRValues.slice(0,3).join(',')}}${multiRValues.length > 3 ? '...' : ''}`;
                    } else if (mode === 'multi-m') {
                        label = `m=${m}`;
                    } else {
                        label = `m=${m}`;
                    }
                    ctx.fillText(label, centerX + radius + 10, centerY);
                }

                // Special handling for m=1
                if (m === 1) {
                    const theta = globalRot + localRot + individualRot * (m - minMod);
                    const x = centerX + radius * Math.cos(theta);
                    const y = centerY - radius * Math.sin(theta);
                    
                    const isTracked = (1 === trackR);
                    const size = (highlightTracked && isTracked) ? pointSize * 2 : pointSize;
                    
                    ctx.fillStyle = (highlightTracked && isTracked) ? '#FFD700' : '#27ae60';
                    ctx.beginPath();
                    ctx.arc(x, y, size, 0, 2 * Math.PI);
                    ctx.fill();
                    
                    if (highlightTracked && isTracked) {
                        ctx.strokeStyle = '#FF8C00';
                        ctx.lineWidth = 2;
                        ctx.stroke();
                    }
                    continue;
                }

                // Draw residue points
                const startR = (mode === 'fixed-m' || mode === 'multi-m') ? 1 : (mode === 'fixed-r' ? fixedR : 1);
                const endR = (mode === 'fixed-m' || mode === 'multi-m') ? m - 1 : (mode === 'fixed-r' ? fixedR : m - 1);

                for (let r = startR; r <= endR; r++) {
                    if (mode === 'fixed-r' && r !== fixedR) continue;
                    if (mode === 'multi-r' && !multiRValues.includes(r)) continue;
                    if (r >= m) continue;

                    const gcdVal = gcd(r, m);
                    const isOpen = gcdVal === 1;
                    
                    if (mode === 'open-only' && !isOpen) continue;

                    // Check if we should show this r
                    const isTracked = (r === trackR);
                    if (!showAllR && !isTracked) continue;

                    // Apply rotations
                    const baseTheta = (2 * Math.PI * r) / m;
                    const theta = baseTheta + globalRot + localRot + individualRot * (m - minMod);
                    const x = centerX + radius * Math.cos(theta);
                    const y = centerY - radius * Math.sin(theta);

                    // Determine color based on color mode
                    let color;
                    const residueK = parseInt(document.getElementById('residueK')?.value || 3);
                    
                    switch(colorMode) {
                        case 'open-blocked':
                            color = isOpen ? (prime ? '#27ae60' : '#3498db') : '#e74c3c';
                            break;
                        case 'gcd-gradient':
                            color = getGCDGradientColor(gcdVal, Math.max(...Array.from(allGCDs)));
                            break;
                        case 'gcd-local':
                            color = getGCDColor(gcdVal, Math.max(...Array.from(allGCDs)));
                            break;
                        case 'gcd-global':
                            color = getGCDColorGlobal(gcdVal);
                            break;
                        case 'prime-factor':
                            color = getSmallestPrimeFactorColor(gcdVal);
                            break;
                        case 'density-local':
                            color = getLocalDensityColor(r, m);
                            break;
                        case 'residue-class':
                            color = getResidueClassColor(r, residueK);
                            break;
                        case 'farey-level':
                            color = getFareyLevelColor(r, m);
                            break;
                        case 'angular-hue':
                            color = getAngularHueColor(r, m);
                            break;
                        case 'multi-property':
                            const inSlice = r <= Math.floor(m/2);
                            color = getMultiPropertyColor(r, m, inSlice);
                            break;
                        default:
                            color = isOpen ? '#27ae60' : '#e74c3c';
                    }

                    // Highlight tracked residue
                    const size = (highlightTracked && isTracked) ? pointSize * 2 : pointSize;
                    if (highlightTracked && isTracked) {
                        color = '#FFD700'; // Gold for tracked
                    }

                    // Draw point
                    const shouldFill = colorMode !== 'open-blocked' || isOpen;
                    
                    // Check if we should show GCD=1 labels
                    const showGCD1Labels = document.getElementById('showGCD1Labels')?.checked || false;
                    const hideGCD1Dots = document.getElementById('hideGCD1Dots')?.checked || false;
                    
                    // Draw dot (unless hidden for GCD=1 labels)
                    if (!(isOpen && showGCD1Labels && hideGCD1Dots)) {
                        if (shouldFill) {
                            ctx.fillStyle = color;
                            ctx.beginPath();
                            ctx.arc(x, y, size, 0, 2 * Math.PI);
                            ctx.fill();
                            
                            if (highlightTracked && isTracked) {
                                ctx.strokeStyle = '#FF8C00';
                                ctx.lineWidth = 2;
                                ctx.stroke();
                            }
                        } else {
                            ctx.strokeStyle = color;
                            ctx.lineWidth = Math.max(1.5, size * 0.5);
                            ctx.beginPath();
                            ctx.arc(x, y, size, 0, 2 * Math.PI);
                            ctx.stroke();
                        }
                    }
                    
                    // Draw label if GCD=1 and labels enabled
                    if (isOpen && showGCD1Labels) {
                        const labelType = document.getElementById('labelType')?.value || 'r-value';
                        const labelSize = parseInt(document.getElementById('labelFontSize')?.value || 10);
                        const labelColorOption = document.getElementById('labelColor')?.value || 'auto';
                        
                        // Determine label text
                        let labelText = '';
                        switch(labelType) {
                            case 'r-value':
                                labelText = r.toString();
                                break;
                            case 'gcd-value':
                                labelText = '1';
                                break;
                            case 'mod-value':
                                labelText = m.toString();
                                break;
                            case 'farey':
                                labelText = `${r}/${m}`;
                                break;
                            case 'theta-deg':
                                const deg = ((baseTheta * 180 / Math.PI) + (globalRot + localRot + individualRot * (m - minMod)) * 180 / Math.PI) % 360;
                                labelText = deg.toFixed(0) + '';
                                break;
                            case 'theta-rad':
                                const rad = theta % (2 * Math.PI);
                                labelText = rad.toFixed(2);
                                break;
                            case 'both-rm':
                                labelText = `${r},${m}`;
                                break;
                            default:
                                labelText = r.toString();
                        }
                        
                        // Determine label color
                        let labelColor;
                        if (labelColorOption === 'auto') {
                            labelColor = darkBg ? 'white' : 'black';
                        } else if (labelColorOption === 'white') {
                            labelColor = 'white';
                        } else if (labelColorOption === 'black') {
                            labelColor = 'black';
                        } else if (labelColorOption === 'green') {
                            labelColor = '#27ae60';
                        } else if (labelColorOption === 'blue') {
                            labelColor = '#3498db';
                        } else if (labelColorOption === 'cyan') {
                            labelColor = '#00ffff';
                        } else if (labelColorOption === 'yellow') {
                            labelColor = '#ffff00';
                        }
                        
                        // Draw label with background for readability
                        ctx.font = `${labelSize}px Arial`;
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        
                        // Measure text for background
                        const metrics = ctx.measureText(labelText);
                        const textWidth = metrics.width;
                        const textHeight = labelSize;
                        const padding = 2;
                        
                        // Draw semi-transparent background
                        ctx.fillStyle = darkBg ? 'rgba(0,0,0,0.7)' : 'rgba(255,255,255,0.7)';
                        ctx.fillRect(
                            x - textWidth/2 - padding,
                            y - textHeight/2 - padding,
                            textWidth + padding*2,
                            textHeight + padding*2
                        );
                        
                        // Draw label text
                        ctx.fillStyle = labelColor;
                        ctx.fillText(labelText, x, y);
                    }
                }
            }

            // Draw enhanced legend
            if (showLegend) {
                const legendX = 30;
                const legendY = height - Math.min(height * 0.4, 400);
                const legendWidth = 300;
                let legendHeight = 120;

                // Calculate legend height based on content
                if (colorMode.startsWith('gcd')) {
                    legendHeight = Math.min(height * 0.35, 80 + allGCDs.size * 22);
                }

                ctx.fillStyle = darkBg ? 'rgba(40, 40, 40, 0.95)' : 'rgba(255, 255, 255, 0.95)';
                ctx.fillRect(legendX, legendY, legendWidth, legendHeight);
                ctx.strokeStyle = '#667eea';
                ctx.lineWidth = 3;
                ctx.strokeRect(legendX, legendY, legendWidth, legendHeight);

                ctx.font = `bold ${Math.max(11, width/220)}px Arial`;
                ctx.fillStyle = textColor;
                let yOffset = legendY + 20;
                
                ctx.fillText(`Color Mode: ${colorMode}`, legendX + 10, yOffset);
                yOffset += 25;

                if (colorMode === 'open-blocked') {
                    ctx.font = `${Math.max(10, width/240)}px Arial`;
                    ctx.fillStyle = '#27ae60';
                    ctx.beginPath();
                    ctx.arc(legendX + 15, yOffset, 5, 0, 2 * Math.PI);
                    ctx.fill();
                    ctx.fillStyle = textColor;
                    ctx.fillText('Open (coprime)', legendX + 28, yOffset + 4);

                    yOffset += 22;
                    ctx.strokeStyle = '#e74c3c';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.arc(legendX + 15, yOffset, 5, 0, 2 * Math.PI);
                    ctx.stroke();
                    ctx.fillStyle = textColor;
                    ctx.fillText('Blocked', legendX + 28, yOffset + 4);
                } else if (colorMode.includes('gcd')) {
                    // Show all GCD values found
                    ctx.font = `${Math.max(10, width/240)}px Arial`;
                    const sortedGCDs = Array.from(allGCDs).sort((a,b) => a-b);
                    sortedGCDs.forEach(g => {
                        let color;
                        if (colorMode === 'gcd-global') {
                            color = getGCDColorGlobal(g);
                        } else {
                            color = getGCDColor(g, Math.max(...sortedGCDs));
                        }
                        
                        ctx.fillStyle = color;
                        ctx.beginPath();
                        ctx.arc(legendX + 15, yOffset, 5, 0, 2 * Math.PI);
                        ctx.fill();
                        ctx.fillStyle = textColor;
                        ctx.fillText(`gcd = ${g}`, legendX + 28, yOffset + 4);
                        yOffset += 20;
                    });
                }

                // Add tracking info if enabled
                if (highlightTracked) {
                    yOffset += 5;
                    ctx.fillStyle = '#FFD700';
                    ctx.beginPath();
                    ctx.arc(legendX + 15, yOffset, 6, 0, 2 * Math.PI);
                    ctx.fill();
                    ctx.strokeStyle = '#FF8C00';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    ctx.fillStyle = textColor;
                    ctx.fillText(`Tracked: r=${trackR}`, legendX + 28, yOffset + 5);
                }
            }

            // Title
            ctx.fillStyle = textColor;
            ctx.font = `bold ${Math.max(16, width/160)}px Arial`;
            ctx.textAlign = 'center';
            const title = invertRings ? 
                         `Concentric Rings (Inverted): m  [${minMod}, ${maxMod}]` :
                         `Concentric Rings: m  [${minMod}, ${maxMod}]`;
            ctx.fillText(title, centerX, 35);
        }

        // Enhanced export function with resolution options
        const originalExportConcentric = exportConcentricView;
        exportConcentricView = function(quality = '4k') {
            const canvas = document.getElementById('concentricCanvas');
            const currentWidth = canvas.width;
            
            if (quality === 'hd') {
                // Temporarily set to HD
                canvas.width = 1920;
                canvas.height = 1920;
                drawConcentricRings();
            }
            
            const link = document.createElement('a');
            link.download = `concentric-rings-${quality}-${Date.now()}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
            
            // Restore original resolution
            if (quality === 'hd') {
                canvas.width = currentWidth;
                canvas.height = currentWidth;
                drawConcentricRings();
            }
        };

        // Modified runFractionalTest to save to history
        const originalRunFractionalTest = runFractionalTest;
        runFractionalTest = function() {
            originalRunFractionalTest();

            // Save to history
            const m = parseInt(document.getElementById('testModulus').value);
            const k = parseInt(document.getElementById('sampleCount').value);
            const sliceType = document.getElementById('sliceType').value;
            const slice = getSlice(m, sliceType);
            
            let passedSamples = 0;
            let allPass = true;
            for (let i = 0; i < k; i++) {
                const r = slice[Math.floor(Math.random() * slice.length)];
                if (gcd(r, m) === 1) passedSamples++;
                else allPass = false;
            }

            const result = {
                type: 'Single Test',
                timestamp: new Date().toLocaleString(),
                modulus: m,
                prime: isPrime(m),
                passed: allPass,
                k: k,
                passedSamples: passedSamples,
                density: (eulerPhi(m) / m).toFixed(4),
                smallestFactor: smallestPrimeFactor(m),
                theoreticalProb: Math.pow(1 - 1/smallestPrimeFactor(m), k).toFixed(4),
                sliceType: sliceType
            };

            addToHistory(result);
        };

        // Initialize concentric rings
        drawConcentricRings();
    </script>




      
    </div>
    <script src="./Farey _ Farey_files/anchor.min.js.download" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  

</body></html>